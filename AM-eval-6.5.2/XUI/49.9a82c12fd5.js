(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[49],{1416:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;"value"in n&&(n.writable=true);Object.defineProperty(e,n.key,n)}}return function(t,r,n){r&&e(t.prototype,r);n&&e(t,n);return t}}();var a=r(3);var o=r(6);var s=r(570);var c=r(0);var i=I(c);var u=r(1);var l=I(u);var p=r(1586);var d=r(186);var f=r(269);var h=r(283);var v=r(270);var y=r(1527);var g=I(y);var m=r(1543);var b=I(m);var C=r(560);var T=I(C);var A=r(1722);var S=I(A);var P=r(73);var _=I(P);var O=r(1721);var w=I(O);function I(e){return e&&e.__esModule?e:{default:e}}function R(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(a,o){try{var s=t[a](o);var c=s.value}catch(e){r(e);return}if(!s.done)return Promise.resolve(c).then(function(e){n("next",e)},function(e){n("throw",e)});e(c)}return n("next")})}}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function k(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var x=function(e){k(t,e);function t(e){E(this,t);var r=U(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));r.state={id:"",isFetching:true};r.handleCreate=r.handleCreate.bind(r);r.handleIdChange=r.handleIdChange.bind(r);r.handleTypeChange=r.handleTypeChange.bind(r);return r}n(t,[{key:"componentDidMount",value:function(){var e=R(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function e(n){while(1)switch(n.prev=n.next){case 0:this.props.resetSelected();n.prev=1;n.next=4;return(0,p.getCreatableTypes)();case 4:t=n.sent;r=t.result;this.props.setTypes(r);n.next=12;break;case 9:n.prev=9;n.t0=n["catch"](1);T.default.addMessage({response:n.t0,type:T.default.TYPE_DANGER});case 12:n.prev=12;this.setState({isFetching:false});return n.finish(12);case 15:case"end":return n.stop()}},e,this,[[1,9,12,15]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"handleCreate",value:function(){var e=R(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function e(r){while(1)switch(r.prev=r.next){case 0:r.prev=0;r.next=3;return(0,p.create)(this.props.selectedType,t,this.state.id);case 3:_.default.routeTo(_.default.configuration.routes.editGlobalSecretStores,{args:(0,o.map)([this.props.selectedType,this.state.id],encodeURIComponent),trigger:true});r.next=9;break;case 6:r.prev=6;r.t0=r["catch"](0);T.default.addMessage({response:r.t0,type:T.default.TYPE_DANGER});case 9:case"end":return r.stop()}},e,this,[[0,6]])}));function t(t){return e.apply(this,arguments)}return t}()},{key:"handleIdChange",value:function e(t){this.setState({id:t})}},{key:"handleTypeChange",value:function(){var e=R(regeneratorRuntime.mark(function e(t){var r,n,a,o;return regeneratorRuntime.wrap(function e(s){while(1)switch(s.prev=s.next){case 0:this.props.setSelected(t);s.prev=1;s.next=4;return(0,p.getInitialState)(t);case 4:r=s.sent;n=r.schema;a=r.values;o=(0,w.default)(n,t);this.props.addOrUpdateSchema(o,t);this.props.addOrUpdateTemplate(a,t);s.next=15;break;case 12:s.prev=12;s.t0=s["catch"](1);T.default.addMessage({response:s.t0,type:T.default.TYPE_DANGER});case 15:case"end":return s.stop()}},e,this,[[1,12]])}));function t(t){return e.apply(this,arguments)}return t}()},{key:"render",value:function e(){var t=(0,b.default)(this.state.id);var r=t&&!(0,o.isEmpty)(this.state.id)&&!(0,o.isEmpty)(this.props.selectedType);return l.default.createElement(s.Grid,null,l.default.createElement(S.default,{id:this.state.id,isCreateAllowed:r,isFetching:this.state.isFetching,isValidId:t,listRoute:_.default.configuration.routes.listGlobalSecretStores,onCreate:this.handleCreate,onIdChange:this.handleIdChange,onTypeChange:this.handleTypeChange,schema:this.props.schema,selectedType:this.props.selectedType,template:this.props.template,types:this.props.types}))}}]);return t}(u.Component);x.propTypes={addOrUpdateSchema:i.default.func.isRequired,addOrUpdateTemplate:i.default.func.isRequired,resetSelected:i.default.func.isRequired,schema:i.default.objectOf(i.default.any),selectedType:i.default.string,setSelected:i.default.func.isRequired,setTypes:i.default.func.isRequired,template:i.default.objectOf(i.default.any),types:i.default.arrayOf(i.default.object).isRequired};x=(0,g.default)(x,function(e){var t=e.local.config.global.secretStores.types.selected;return{schema:(0,o.get)(e.remote.config.global.secretStores.types.schema,[t]),selectedType:t,template:(0,o.get)(e.remote.config.global.secretStores.types.template,[t]),types:e.remote.config.global.secretStores.types.list}},function(e){return{addOrUpdateSchema:(0,a.bindActionCreators)(d.addOrUpdate,e),addOrUpdateTemplate:(0,a.bindActionCreators)(f.addOrUpdate,e),resetSelected:(0,a.bindActionCreators)(h.reset,e),setSelected:(0,a.bindActionCreators)(h.set,e),setTypes:(0,a.bindActionCreators)(v.set,e)}});t.default=x},1586:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.get=p;t.getSingleton=d;t.create=f;t.getAll=h;t.getCreatableTypesByType=v;t.getSingletonTypes=y;t.getCreatableTypes=g;t.getSchema=m;t.getInitialState=b;t.remove=C;t.update=T;t.updateSingleton=A;var n=r(6);var a=r(169);var o=i(a);var s=r(27);var c=i(s);function i(e){return e&&e.__esModule?e:{default:e}}var u=new o.default(""+c.default.host+c.default.context+"/json");var l="/global-config/secrets/stores";function p(e,t){return u.serviceCall({url:l+"/"+e+"/"+encodeURIComponent(t),headers:{"Accept-API-Version":"protocol=2.0,resource=1.0"}})}function d(e){return u.serviceCall({url:l+"/"+e,headers:{"Accept-API-Version":"protocol=2.0,resource=1.0"}})}function f(e,t,r){return u.serviceCall({url:l+"/"+e+"/"+encodeURIComponent(r),type:"PUT",headers:{"Accept-API-Version":"protocol=2.0,resource=1.0","If-None-Match":"*"},data:JSON.stringify(t)})}function h(e){return u.serviceCall({url:l+"/"+e+"?_queryFilter=true",headers:{"Accept-API-Version":"protocol=2.0,resource=1.0"}})}function v(e){return u.serviceCall({url:l+"/"+e+"?_action=getCreatableTypes",headers:{"Accept-API-Version":"protocol=2.0,resource=1.0"},type:"POST"})}function y(){return u.serviceCall({url:l+"?_action=getAllTypes",headers:{"Accept-API-Version":"protocol=2.0,resource=1.0"},type:"POST"}).then(function(e){var t=e.result;return(0,n.filter)(t,function(e){return false===e.collection})})}function g(){return u.serviceCall({url:l+"?_action=getCreatableTypes",headers:{"Accept-API-Version":"protocol=2.0,resource=1.0"},type:"POST"})}function m(e){return u.serviceCall({url:l+"/"+e+"?_action=schema",headers:{"Accept-API-Version":"protocol=2.0,resource=1.0"},type:"POST"})}function b(e){function t(){return u.serviceCall({url:l+"/"+e+"?_action=template",headers:{"Accept-API-Version":"protocol=2.0,resource=1.0"},type:"POST"})}return Promise.all([m(e),t()]).then(function(e){return{schema:e[0],values:e[1]}})}function C(e){var t=(0,n.map)(e,function(e){return u.serviceCall({url:l+"/"+e._type._id+"/"+encodeURIComponent(e._id),headers:{"Accept-API-Version":"protocol=2.0,resource=1.0"},type:"DELETE"})});return Promise.all(t)}function T(e,t,r){return u.serviceCall({url:l+"/"+e+"/"+encodeURIComponent(t),type:"PUT",headers:{"Accept-API-Version":"protocol=2.0,resource=1.0"},data:JSON.stringify((0,n.omit)(r,"_rev"))})}function A(e,t){return u.serviceCall({url:l+"/"+e,type:"PUT",headers:{"Accept-API-Version":"protocol=2.0,resource=1.0"},data:JSON.stringify((0,n.omit)(t,"_rev"))})}}}]);
//# sourceMappingURL=49.9a82c12fd5.js.map