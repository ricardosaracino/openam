(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[30],{1587:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=a(6);var s=p(r);var n=a(19);var i=p(n);var u=a(657);var l=p(u);var o=a(114);var d=p(o);var f=a(1604);var c=p(f);var h=a(586);var v=p(h);function p(e){return e&&e.__esModule?e:{default:e}}function m(e){var t=(0,i.default)(e);var a=void 0;if(t.hasClass("filter-value")&&t.val().length>0)return t.attr("name")+' eq "'+t.val().replace('"','\\"')+'"';if(t.hasClass("filter-group")){a=s.default.chain(t.find(">.form-group>.filter-value, >.filter-group")).map(m).filter(function(e){return e.length>0}).value();if(0===a.length)return"";if(1===a.length)return a[0];return t.hasClass("filter-or")?"("+a.join(" OR ")+")":"("+a.join(" AND ")+")"}return""}var g=d.default.extend({baseTemplate:"user/AnonymousProcessBaseTemplate",template:"user/AnonymousProcessWrapper",events:{"submit form":"formSubmit","click #restart":"restartProcess","change #userQuery :input":"buildQueryFilter","keyup #userQuery :input":"buildQueryFilter","customValidate #userQuery":"validateForm"},data:{i18n:{}},walkTreeForFilterStrings:m,getFormContent:function e(){return"userQuery"===this.$el.find("form").attr("id")?{queryFilter:this.$el.find(":input[name=queryFilter]").val()}:(0,l.default)((0,i.default)(this.element).find("form")[0])},formSubmit:function e(t){var a=this.getFormContent();t.preventDefault();this.delegate.submit(a).then(s.default.bind(this.renderProcessState,this),s.default.bind(this.renderProcessState,this))},parentRender:function e(){d.default.prototype.parentRender.call(this,s.default.bind(function(){this.delegate.start().then(s.default.bind(this.renderProcessState,this))},this))},renderResponse:function e(t){d.default.prototype.parentRender.call(this,s.default.bind(function(){this.renderProcessState(t)},this))},setDelegate:function e(t,a,r){this.delegate=new c.default(t,a,r)},submitDelegate:function e(t,a){this.delegate.submit(s.default.omit(t,"token")).always(a)},setTranslationBase:function e(){s.default.each(["title","completed","failed","tryAgain","return"],s.default.bind(function(e){this.data.i18n[e]=this.i18nBase+"."+e},this))},restartProcess:function e(){},attemptCustomTemplate:function e(t,a,r){var s=this;this.loadThemedTemplate("user/process/"+this.processType+"/"+a.type+"-"+a.tag).then(function(e){var a=e(t);r.resolve(a)},function(){s.loadGenericTemplate(t,a,r)})},loadGenericTemplate:function e(t,a,r){var n=s.default.has(a,"requirements")?"GenericInputForm":"GenericEndPage";this.loadThemedTemplate("user/process/"+n).then(function(e){var a=e(t);r.resolve(a)})},renderProcessState:function e(t){var a=i.default.Deferred();s.default.has(t,"requirements")?this.stateData=s.default.extend({requirements:t.requirements},this.data):this.stateData=s.default.extend({status:t.status,additions:t.additions},this.data);s.default.has(t,"type")&&s.default.has(t,"tag")?this.attemptCustomTemplate(this.stateData,t,a):this.loadGenericTemplate(this.stateData,t,a);return a.then(s.default.bind(function(e){this.$el.find("#processContent").html(e);v.default.bindValidators(this.$el,this.baseEntity,s.default.bind(function(){v.default.validateAllFields(this.$el)},this))},this))},buildQueryFilter:function e(){this.$el.find(":input[name=queryFilter]").val(m(this.$el.find("#filterContainer")));this.validateForm()},validateForm:function e(){var t=this.$el.find("input[type=submit]");var a=false;if(0===this.$el.find(":input[name=queryFilter]").val().length){t.prop("disabled",true);return}this.$el.find(".filter-and").each(function(){m(this).length>0?a=!(s.default.reduce((0,i.default)(">.form-group>.filter-value",this),function(e,t){var a=t.value.length>0;(0,i.default)(t).attr("data-validation-status",a?"ok":"error");return e&&a},true)&&s.default.reduce((0,i.default)(">.filter-group",this),function(e,t){return m(t).length>0},true)):(0,i.default)(">.form-group>.filter-value",this).attr("data-validation-status","ok")});t.prop("disabled",a)}});t.default=g},1604:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=a(6);var s=f(r);var n=a(19);var i=f(n);var u=a(169);var l=f(u);var o=a(27);var d=f(o);function f(e){return e&&e.__esModule?e:{default:e}}var c=function e(t,a,r){this.token=a;this.additional=r||"";return l.default.call(this,d.default.context+"/"+t)};var h=function e(t,a){var r=i.default.Deferred();var n=void 0;if("parameters"===t.type){n=s.default.intersection(s.default.keys(a),s.default.keys(t.requirements.properties));this.lastResponse=t;this.submit(s.default.pick(a,n)).then(s.default.bind(function(e){var t=s.default.omit(a,n);s.default.isEmpty(t)?r.resolve(e):this.submit(t).then(r.resolve,r.reject)},this),r.reject)}else if(s.default.isEmpty(a))r.resolve(t);else{this.lastResponse=t;this.submit(a).then(r.resolve,r.reject)}return r};c.prototype=Object.create(l.default.prototype);c.prototype.constructor=c;c.prototype.start=function(e){e=e||{};return this.lastResponse?i.default.Deferred().resolve(this.lastResponse):this.serviceCall({type:"GET",url:"",headers:{"Accept-API-Version":"protocol=1.0,resource=1.0"}}).then(s.default.bind(function(t){return h.call(this,t,e).then(s.default.bind(function(e){this.lastResponse=e;return this.lastResponse},this))},this))};c.prototype.submit=function(e){var t=void 0;t=this.token||this.lastResponse?this.serviceCall({type:"POST",url:"?_action=submitRequirements"+this.additional,data:JSON.stringify({token:this.token,input:e}),headers:{"Accept-API-Version":"protocol=1.0,resource=1.0"},errorsHandlers:{failed:{status:"400"}}}):this.start(e);return t.then(s.default.bind(function(e){s.default.has(e,"token")&&(this.token=e.token);this.lastResponse=e;return e},this),s.default.bind(function(e){delete this.token;delete this.lastResponse;return s.default.has(e,"responseJSON.message")?{status:{success:false,reason:e.responseJSON.message,code:e.responseJSON.code}}:e},this))};t.default=c},1605:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=a(6);var s=F(r);var n=a(61);var i=F(n);var u=a(571);var l=a(1587);var o=F(l);var d=a(27);var f=F(d);var c=a(59);var h=F(c);var v=a(168);var p=F(v);var m=a(170);var g=F(m);var y=a(560);var b=F(y);var S=a(73);var R=F(S);var E=a(81);var _=F(E);var T=a(63);var P=F(T);function F(e){return e&&e.__esModule?e:{default:e}}function k(e){if(e===f.default.SELF_SERVICE_REGISTER)return R.default.configuration.routes.continueSelfRegister;if(e===f.default.SELF_SERVICE_RESET_PASSWORD)return R.default.configuration.routes.continuePasswordReset;return""}function D(e){return e.token}function O(e){return-1!==e.indexOf(f.default.SELF_SERVICE_REGISTER)}function C(e){return-1!==e.indexOf(f.default.SELF_SERVICE_RESET_PASSWORD)}function I(e,t){var a=void 0;409===e||s.default.startsWith(t,"ldap exception")||s.default.startsWith(t,"Resource already exists")?a=i.default.t("config.messages.UserMessages.registerDataInvalid"):400===e&&s.default.startsWith(t,"CONSTRAINT_VIOLATION")?a=i.default.t("config.messages.UserMessages.registerDataInvalid"):s.default.startsWith(t,"Identity names may not have a space character")&&(a=i.default.t("config.messages.UserMessages.registerDataInvalid"));return a}t.default=o.default.extend({render:function e(){var t=this;var a=(0,u.parseParameters)(P.default.getCurrentFragmentQueryString());var r=k(this.endpoint);var n=(0,p.default)("/"+this.endpoint,{realm:_.default.getState().remote.info.realm});var i=function e(){t.data.fragmentParamString=(0,g.default)();t.data.args=[void 0,t.data.fragmentParamString];t.setTranslationBase()};this.delegate&&R.default.currentRoute===r||this.setDelegate("json"+n,a.token);if(D(a))this.submitDelegate(a,function(e){var i=s.default.get(e,"status");var l=i&&false===i.success;if(C(n)&&l){delete a["token"];delete a["code"];t.data.fragmentParamString=s.default.isEmpty(a)?"":"&"+(0,u.urlParamsFromObject)(a);t.data.args=[void 0,t.data.fragmentParamString];t.setTranslationBase();t.renderResponse(e)}else if(O(n)&&l){var o=I(i.code,i.reason);o&&b.default.addMessage({message:o,type:b.default.TYPE_DANGER});R.default.routeTo(R.default.currentRoute,{trigger:true})}else R.default.routeTo(r,{trigger:true})});else{i();this.parentRender()}},restartProcess:function e(t){t.preventDefault();delete this.delegate;delete this.stateData;h.default.sendEvent(f.default.EVENT_CHANGE_VIEW,{args:this.data.args,route:s.default.extend({},R.default.currentRoute,{forceUpdate:true})})}})},1740:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=a(1587);var s=n(r);function n(e){return e&&e.__esModule?e:{default:e}}var i=s.default.extend({processType:"reset",i18nBase:"common.user.passwordReset"});t.default=new i},878:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=a(6);var s=f(r);var n=a(27);var i=f(n);var u=a(1605);var l=f(u);var o=a(1740);var d=f(o);function f(e){return e&&e.__esModule?e:{default:e}}function c(){}c.prototype=d.default;c.prototype.endpoint=i.default.SELF_SERVICE_RESET_PASSWORD;s.default.extend(c.prototype,l.default.prototype);t.default=new c}}]);
//# sourceMappingURL=30.70526e2980.js.map