#
# Copyright 2018-2019 ForgeRock AS. All Rights Reserved
#
# Use of this code requires a commercial software license with ForgeRock AS.
# or with one of its affiliates. All use shall be exclusively subject
# to such license between the licensee and ForgeRock AS.
#
dn: &{AM_IDENTITY_STORE_BASE_DN}
objectClass: top
objectClass: untypedObject
aci: (targetattr="* || aci")(version 3.0;acl "Allow identity modification";
 allow (write)(userdn = "ldap:///uid=am-identity-bind-account,ou=admins,&{AM_IDENTITY_STORE_BASE_DN}");)
aci: (targetattr!="userPassword||authPassword")(version 3.0;
 acl "Allow identity search"; allow (search, read)
 (userdn = "ldap:///uid=am-identity-bind-account,ou=admins,&{AM_IDENTITY_STORE_BASE_DN}");)
aci: (targetattr="+")(version 3.0;
 acl "Allow identity search operational attributes"; allow (search, read)
 (userdn = "ldap:///uid=am-identity-bind-account,ou=admins,&{AM_IDENTITY_STORE_BASE_DN}");)
aci: (version 3.0;acl "Add, delete, proxy identities"; allow (add, delete, proxy)
 (userdn = "ldap:///uid=am-identity-bind-account,ou=admins,&{AM_IDENTITY_STORE_BASE_DN}");)
aci: (targetcontrol="2.16.840.1.113730.3.4.3||1.3.6.1.4.1.42.2.27.8.5.1||2.16.840.1.113730.3.4.18")
 (version 3.0;acl "Allow persistent search, password policy and proxied authz controls"; allow (read)
 (userdn = "ldap:///uid=am-identity-bind-account,ou=admins,&{AM_IDENTITY_STORE_BASE_DN}");)

dn: ou=people,&{AM_IDENTITY_STORE_BASE_DN}
objectClass: organizationalunit
objectClass: top
ou: people

dn: ou=groups,&{AM_IDENTITY_STORE_BASE_DN}
objectClass: organizationalunit
objectClass: top
ou: groups

dn: ou=admins,&{AM_IDENTITY_STORE_BASE_DN}
objectClass: top
objectClass: organizationalunit
ou: admins

dn: uid=am-identity-bind-account,ou=admins,&{AM_IDENTITY_STORE_BASE_DN}
objectClass: top
objectClass: person
objectClass: organizationalPerson
objectClass: inetOrgPerson
cn: am-identity-bind-account
sn: am-identity-bind-account
uid: am-identity-bind-account
userPassword: &{AM_IDENTITY_STORE_ADMIN_PASSWORD}
ds-privilege-name: password-reset
ds-privilege-name: proxied-auth
ds-privilege-name: modify-acl
