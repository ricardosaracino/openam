(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[24,249,250,251,252,398],{1168:function(e,t,a){var n=a(62);e.exports=(n["default"]||n).template({1:function(e,t,a,n,l){var r;return"alert-"+e.escapeExpression((r=null!=(r=a.type||(null!=t?t.type:t))?r:a.helperMissing,"function"===typeof r?r.call(null!=t?t:e.nullContext||{},{name:"type",hash:{},data:l}):r))},3:function(e,t,a,n,l){return'<button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">Ã—</span><span class="sr-only">'+e.escapeExpression((a.t||t&&t.t||a.helperMissing).call(null!=t?t:e.nullContext||{},"console.common.form.close",{name:"t",hash:{},data:l}))+"</span></button>"},5:function(e,t,a,n,l){return'            <i class="fa fa-check-circle-o"></i>\n'},7:function(e,t,a,n,l){return'            <i class="fa fa-exclamation-circle"></i>\n'},compiler:[7,">= 4.0.0"],main:function(e,t,a,n,l){var r,i=null!=t?t:e.nullContext||{},s=a.helperMissing;return'\x3c!--\n  Copyright 2015-2017 ForgeRock AS. All Rights Reserved\n \n  Use of this code requires a commercial software license with ForgeRock AS.\n  or with one of its affiliates. All use shall be exclusively subject\n  to such license between the licensee and ForgeRock AS.\n--\x3e\n<div class="alert '+(null!=(r=a["if"].call(i,null!=t?t.type:t,{name:"if",hash:{},fn:e.program(1,l,0),inverse:e.noop,data:l}))?r:"")+'" role="alert">\n    <div class="media">\n        '+(null!=(r=a["if"].call(i,null!=t?t.dismissable:t,{name:"if",hash:{},fn:e.program(3,l,0),inverse:e.noop,data:l}))?r:"")+'\n        <div class="media-left" href="#">\n'+(null!=(r=(a.equals||t&&t.equals||s).call(i,null!=t?t.type:t,"success",{name:"equals",hash:{},fn:e.program(5,l,0),inverse:e.program(7,l,0),data:l}))?r:"")+'        </div>\n        <div class="media-body">\n            '+e.escapeExpression((a.t||t&&t.t||s).call(i,null!=t?t.text:t,{name:"t",hash:{},data:l}))+"\n        </div>\n    </div>\n</div>\n"},useData:true})},1205:function(e,t,a){var n=a(62);e.exports=(n["default"]||n).template({1:function(e,t,a,n,l){return" alert-success "},3:function(e,t,a,n,l){return" alert-danger "},5:function(e,t,a,n,l){return'            <i class="fa fa-check-circle-o"></i>\n'},7:function(e,t,a,n,l){return'            <i class="fa fa-exclamation-circle"></i>\n'},9:function(e,t,a,n,l){var r,i=null!=t?t:e.nullContext||{};return"            "+e.escapeExpression((a.t||t&&t.t||a.helperMissing).call(i,"console.scripts.edit.validation.errors",{name:"t",hash:{},data:l}))+'\n            <pre class="validation-error">\n'+(null!=(r=a.each.call(i,null!=t?t.errors:t,{name:"each",hash:{},fn:e.program(10,l,0),inverse:e.noop,data:l}))?r:"")+"            </pre>\n"},10:function(e,t,a,n,l){var r=null!=t?t:e.nullContext||{},i=a.helperMissing,s=e.escapeExpression,o=e.lambda;return'               <span class="validation-key">'+s((a.t||t&&t.t||i).call(r,"console.scripts.edit.validation.line",{name:"t",hash:{},data:l}))+":</span> "+s(o(null!=t?t.line:t,t))+'\n               <span class="validation-key">'+s((a.t||t&&t.t||i).call(r,"console.scripts.edit.validation.column",{name:"t",hash:{},data:l}))+":</span> "+s(o(null!=t?t.column:t,t))+'\n               <span class="validation-key">'+s((a.t||t&&t.t||i).call(r,"console.scripts.edit.validation.message",{name:"t",hash:{},data:l}))+":</span> "+s(o(null!=t?t.message:t,t))+"\n"},12:function(e,t,a,n,l){return"            "+e.escapeExpression((a.t||t&&t.t||a.helperMissing).call(null!=t?t:e.nullContext||{},"console.scripts.edit.validation.noErrors",{name:"t",hash:{},data:l}))+"\n"},compiler:[7,">= 4.0.0"],main:function(e,t,a,n,l){var r,i=null!=t?t:e.nullContext||{};return'<div class="alert '+(null!=(r=a["if"].call(i,null!=t?t.success:t,{name:"if",hash:{},fn:e.program(1,l,0),inverse:e.program(3,l,0),data:l}))?r:"")+'" role="alert">\n    <div class="media">\n        <button type="button" class="close" data-dismiss="alert">\n            <span aria-hidden="true" class="fa fa-times"></span><span class="sr-only">'+e.escapeExpression((a.t||t&&t.t||a.helperMissing).call(i,"common.form.close",{name:"t",hash:{},data:l}))+'</span>\n        </button>\n        <div class="media-left" href="#">\n'+(null!=(r=a["if"].call(i,null!=t?t.success:t,{name:"if",hash:{},fn:e.program(5,l,0),inverse:e.program(7,l,0),data:l}))?r:"")+'        </div>\n        <div class="media-body">\n'+(null!=(r=a["if"].call(i,null!=t?t.errors:t,{name:"if",hash:{},fn:e.program(9,l,0),inverse:e.program(12,l,0),data:l}))?r:"")+"        </div>\n    </div>\n</div>\n"},useData:true})},1206:function(e,t,a){var n=a(62);e.exports=(n["default"]||n).template({1:function(e,t,a,n,l,r,i){var s,o,u=null!=t?t:e.nullContext||{},c=a.helperMissing,d="function",f=e.escapeExpression;return'                    <option value="'+f((o=null!=(o=a._id||(null!=t?t._id:t))?o:c,typeof o===d?o.call(u,{name:"_id",hash:{},data:l}):o))+'" '+(null!=(s=(a.equals||t&&t.equals||c).call(u,null!=i[2]?i[2].defaultContext:i[2],null!=t?t._id:t,{name:"equals",hash:{},fn:e.program(2,l,0,r,i),inverse:e.noop,data:l}))?s:"")+" >\n                        "+f((o=null!=(o=a.name||(null!=t?t.name:t))?o:c,typeof o===d?o.call(u,{name:"name",hash:{},data:l}):o))+"\n                    </option>\n"},2:function(e,t,a,n,l){return" selected "},compiler:[7,">= 4.0.0"],main:function(e,t,a,n,l,r,i){var s,o=null!=t?t:e.nullContext||{},u=a.helperMissing,c=e.escapeExpression;return(null!=(s=e.invokePartial(n["headers/_Title"],t,{name:"headers/_Title",hash:{title:"console.scripts.edit.title"},data:l,helpers:a,partials:n,decorators:e.decorators}))?s:"")+'\n<div class="panel panel-default panel-content">\n\n    <div class="panel-body form-horizontal">\n        \x3c!-- NAME --\x3e\n        <div class="form-group">\n            <label class="col-sm-2 control-label" for="name">'+c((a.t||t&&t.t||u).call(o,"console.common.name",{name:"t",hash:{},data:l}))+'</label>\n\n            <div class="col-sm-9">\n                <input type="text" id="name" name="scriptName" class="form-control" value="'+c(e.lambda(null!=(s=null!=t?t.entity:t)?s.name:s,t))+'"\n                       data-field="name" placeholder="'+c((a.t||t&&t.t||u).call(o,"common.form.validation.required",{name:"t",hash:{},data:l}))+'" autofocus required>\n            </div>\n        </div>\n        \x3c!-- CONTEXT --\x3e\n        <div class="form-group">\n            <label class="col-sm-2 control-label" for="context">'+c((a.t||t&&t.t||u).call(o,"console.scripts.edit.scriptType",{name:"t",hash:{},data:l}))+'</label>\n\n            <div class="col-sm-9">\n                <select class="form-control" data-field="context" id="context">\n'+(null!=(s=a.each.call(o,null!=t?t.contexts:t,{name:"each",hash:{},fn:e.program(1,l,0,r,i),inverse:e.noop,data:l}))?s:"")+'                </select>\n            </div>\n        </div>\n    </div>\n    <div class="panel-footer clearfix">\n        <div class="pull-right">\n            <a class="btn btn-default" href="'+c((a.routeTo||t&&t.routeTo||u).call(o,"realmsScripts",null!=t?t.realmPath:t,{name:"routeTo",hash:{},data:l}))+'">'+c((a.t||t&&t.t||u).call(o,"common.form.cancel",{name:"t",hash:{},data:l}))+'</a>\n            <button data-save class="btn btn-primary" type="button" disabled>\n                '+c((a.t||t&&t.t||u).call(o,"common.form.create",{name:"t",hash:{},data:l}))+"\n            </button>\n        </div>\n    </div>\n</div>\n"},usePartial:true,useData:true,useDepths:true})},1207:function(e,t,a){var n=a(62);e.exports=(n["default"]||n).template({1:function(e,t,a,n,l,r,i){var s;return null!=(s=a.each.call(null!=t?t:e.nullContext||{},null!=t?t.languages:t,{name:"each",hash:{},fn:e.program(2,l,0,r,i),inverse:e.noop,data:l}))?s:""},2:function(e,t,a,n,l,r,i){var s,o,u=null!=t?t:e.nullContext||{},c=a.helperMissing,d="function",f=e.escapeExpression;return'                    <div class="radio">\n                        <label>\n                            <input type="radio" name="language" id="'+f((o=null!=(o=a.id||(null!=t?t.id:t))?o:c,typeof o===d?o.call(u,{name:"id",hash:{},data:l}):o))+'" value="'+f((o=null!=(o=a.id||(null!=t?t.id:t))?o:c,typeof o===d?o.call(u,{name:"id",hash:{},data:l}):o))+'" data-field="language"\n                                '+(null!=(s=(a.equals||t&&t.equals||c).call(u,null!=(s=null!=i[1]?i[1].entity:i[1])?s.language:s,null!=t?t.id:t,{name:"equals",hash:{},fn:e.program(3,l,0,r,i),inverse:e.noop,data:l}))?s:"")+"> "+f((o=null!=(o=a.name||(null!=t?t.name:t))?o:c,typeof o===d?o.call(u,{name:"name",hash:{},data:l}):o))+"\n                        </label>\n                    </div>\n"},3:function(e,t,a,n,l){return" checked "},5:function(e,t,a,n,l){var r;return null!=(r=a.each.call(null!=t?t:e.nullContext||{},null!=t?t.languages:t,{name:"each",hash:{},fn:e.program(6,l,0),inverse:e.noop,data:l}))?r:""},6:function(e,t,a,n,l){var r;return'                    <input class="form-control" value="'+e.escapeExpression((r=null!=(r=a.name||(null!=t?t.name:t))?r:a.helperMissing,"function"===typeof r?r.call(null!=t?t:e.nullContext||{},{name:"name",hash:{},data:l}):r))+'" readonly />\n'},compiler:[7,">= 4.0.0"],main:function(e,t,a,n,l,r,i){var s,o,u=null!=t?t:e.nullContext||{},c=a.helperMissing,d=e.escapeExpression,f=e.lambda;return(null!=(s=e.invokePartial(n["headers/_TitleWithSubAndIcon"],t,{name:"headers/_TitleWithSubAndIcon",hash:{icon:"code",type:"console.scripts.edit.script",title:null!=(s=null!=t?t.entity:t)?s.name:s},data:l,helpers:a,partials:n,decorators:e.decorators}))?s:"")+'\n<div class="panel panel-default panel-content">\n    <div class="panel-body form-horizontal">\n        \x3c!-- NAME --\x3e\n        <div class="form-group">\n            <label class="col-sm-2 control-label" for="name">'+d((a.t||t&&t.t||c).call(u,"console.common.name",{name:"t",hash:{},data:l}))+'</label>\n\n            <div class="col-sm-9">\n                <input type="text" id="name" name="scriptName" class="form-control" value="'+d(f(null!=(s=null!=t?t.entity:t)?s.name:s,t))+'"\n                       data-field="name" placeholder="'+d((a.t||t&&t.t||c).call(u,"common.form.validation.required",{name:"t",hash:{},data:l}))+'" autofocus required>\n            </div>\n        </div>\n\n        \x3c!-- DESCRIPTION --\x3e\n        <div class="form-group">\n            <label class="col-sm-2 control-label" for="description">'+d((a.t||t&&t.t||c).call(u,"console.common.description",{name:"t",hash:{},data:l}))+'</label>\n\n            <div class="col-sm-9">\n                <textarea id="description" class="form-control pull-left script-text" rows="3"\n                          data-field="description">'+d(f(null!=(s=null!=t?t.entity:t)?s.description:s,t))+'</textarea>\n            </div>\n        </div>\n\n        \x3c!-- CONTEXT --\x3e\n        <div class="form-group">\n            <label class="col-sm-2 control-label" for="context">'+d((a.t||t&&t.t||c).call(u,"console.scripts.edit.scriptType",{name:"t",hash:{},data:l}))+'</label>\n\n            <div class="col-sm-9 script-context">\n                <span class="form-control" id="context">'+d((o=null!=(o=a.contextName||(null!=t?t.contextName:t))?o:c,"function"===typeof o?o.call(u,{name:"contextName",hash:{},data:l}):o))+'</span>\n                <button type="button" class="btn fr-btn-secondary pull-right" data-change-context>\n                    <i class="fa fa-gear"></i> '+d((a.t||t&&t.t||c).call(u,"common.form.change",{name:"t",hash:{},data:l}))+'\n                </button>\n            </div>\n        </div>\n\n        \x3c!-- LANGUAGE --\x3e\n        <div class="form-group">\n            <label class="col-sm-2 control-label">'+d((a.t||t&&t.t||c).call(u,"console.scripts.edit.language",{name:"t",hash:{},data:l}))+'</label>\n\n            <div class="col-sm-9">\n'+(null!=(s=a["if"].call(u,null!=(s=null!=t?t.languages:t)?s["1"]:s,{name:"if",hash:{},fn:e.program(1,l,0,r,i),inverse:e.program(5,l,0,r,i),data:l}))?s:"")+'            </div>\n        </div>\n\n        \x3c!--SCRIPT--\x3e\n        <div class="form-group">\n            <label class="col-sm-2 control-label" for="script">'+d((a.t||t&&t.t||c).call(u,"console.scripts.edit.script",{name:"t",hash:{},data:l}))+'</label>\n\n            <div class="col-sm-9">\n                <div class="script-area">\n                    <textarea id="script">'+d(f(null!=(s=null!=t?t.entity:t)?s.script:s,t))+'</textarea>\n                </div>\n\n                <input type="button" class="btn btn-default script-upload" id="upload" value="'+d((a.t||t&&t.t||c).call(u,"common.form.upload",{name:"t",hash:{},data:l}))+'" data-upload-script>\n                <input type="file" name="upload" class="hidden">\n\n                <input type="button" class="btn btn-default" value="'+d((a.t||t&&t.t||c).call(u,"common.form.validate",{name:"t",hash:{},data:l}))+'" data-validation-script>\n\n                <button type="button" class="btn btn-default" data-show-fullscreen>\n                    <i class="fa fa-expand"></i> '+d((a.t||t&&t.t||c).call(u,"console.common.editFullScreen",{name:"t",hash:{},data:l}))+'\n                </button>\n\n                <div id="validation" class="script-validation-message"></div>\n            </div>\n        </div>\n    </div>\n\n    <div class="panel-footer clearfix">\n        <div class="script-changes-pending pull-left"></div>\n        <button data-save class="btn btn-primary pull-right" type="button">\n            '+d((a.t||t&&t.t||c).call(u,"common.form.saveChanges",{name:"t",hash:{},data:l}))+'\n        </button>\n    </div>\n\n    <div class="full-screen-bar">\n        <button type="button" class="btn btn-link pull-right" data-exit-fullscreen>\n            <i class="fa fa-compress"></i> '+d((a.t||t&&t.t||c).call(u,"console.common.exitFullScreen",{name:"t",hash:{},data:l}))+"\n        </button>\n    </div>\n</div>\n"},usePartial:true,useData:true,useDepths:true})},1208:function(e,t,a){var n=a(62);e.exports=(n["default"]||n).template({1:function(e,t,a,n,l,r,i){var s,o,u=null!=t?t:e.nullContext||{},c=a.helperMissing,d="function",f=e.escapeExpression;return'<div class="radio">\n    <label>\n        <input type="radio" name="changeContext" id="'+f((o=null!=(o=a._id||(null!=t?t._id:t))?o:c,typeof o===d?o.call(u,{name:"_id",hash:{},data:l}):o))+'" value="'+f((o=null!=(o=a._id||(null!=t?t._id:t))?o:c,typeof o===d?o.call(u,{name:"_id",hash:{},data:l}):o))+'"\n'+(null!=(s=a["if"].call(u,null!=i[1]?i[1].newScript:i[1],{name:"if",hash:{},fn:e.program(2,l,0,r,i),inverse:e.program(5,l,0,r,i),data:l}))?s:"")+"        >\n        "+f((o=null!=(o=a.name||(null!=t?t.name:t))?o:c,typeof o===d?o.call(u,{name:"name",hash:{},data:l}):o))+"\n    </label>\n</div>\n"},2:function(e,t,a,n,l,r,i){var s;return"            "+(null!=(s=(a.equals||t&&t.equals||a.helperMissing).call(null!=t?t:e.nullContext||{},null!=i[2]?i[2].defaultContext:i[2],null!=t?t._id:t,{name:"equals",hash:{},fn:e.program(3,l,0,r,i),inverse:e.noop,data:l}))?s:"")+"\n"},3:function(e,t,a,n,l){return" checked "},5:function(e,t,a,n,l,r,i){var s;return"            "+(null!=(s=(a.equals||t&&t.equals||a.helperMissing).call(null!=t?t:e.nullContext||{},null!=(s=null!=i[2]?i[2].entity:i[2])?s.context:s,null!=t?t._id:t,{name:"equals",hash:{},fn:e.program(3,l,0,r,i),inverse:e.noop,data:l}))?s:"")+"\n"},compiler:[7,">= 4.0.0"],main:function(e,t,a,n,l,r,i){var s;return(null!=(s=e.invokePartial(n["alerts/_Alert"],t,{name:"alerts/_Alert",hash:{text:"console.scripts.edit.dialog.warning"},data:l,helpers:a,partials:n,decorators:e.decorators}))?s:"")+"\n"+(null!=(s=a.each.call(null!=t?t:e.nullContext||{},null!=t?t.contexts:t,{name:"each",hash:{},fn:e.program(1,l,0,r,i),inverse:e.noop,data:l}))?s:"")},usePartial:true,useData:true,useDepths:true})},1526:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=s;var n=a(61);var l=a(655);var r=i(l);function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(0,n.t)("common.form.delete");r.default.confirm({type:r.default.TYPE_DANGER,title:(0,n.t)("common.form.confirm")+" "+a,message:e.message?e.message:(0,n.t)("console.common.confirmDeleteText",{type:e.type}),btnOKLabel:a,btnOKClass:"btn-danger",callback:function e(a){a&&t&&t()}})}},1533:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=a(1537);var l=u(n);var r=a(1536);var i=u(r);var s=a(1526);var o=u(s);function u(e){return e&&e.__esModule?e:{default:e}}var c={};c.showConfirmationBeforeDeleting=function(e,t){(0,l.default)("FormHelper.showConfirmationBeforeDeleting","org/forgerock/openam/ui/admin/utils/form/showConfirmationBeforeAction");return(0,o.default)(e,t)};c.setActiveTab=function(e,t){(0,l.default)("FormHelper.setActiveTab","org/forgerock/openam/ui/admin/utils/form/setActiveTab");return(0,i.default)(e,t)};t.default=c},1536:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=function(e){e&&e.activeTabId&&e.$el.find('.nav-tabs a[href="'+e.activeTabId+'"]').tab("show")}},1537:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=n;function n(e,t){console.warn(e+" is marked as deprecated. \nPlease use "+t)}},1550:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=a(6);var l=u(n);var r=a(37);var i=u(r);var s=a(63);var o=u(s);function u(e){return e&&e.__esModule?e:{default:e}}var c={};c.decorateURLWithOverrideRealm=function(e){var t=c.getOverrideRealm(),a,n,l;if(t){if(-1!==e.indexOf("realm="))return e;n=e.indexOf("#");if(-1!==n){l=e.slice(n);e=e.slice(0,n)}a=-1===e.indexOf("?")?"?":"&";e=""+e+a+"realm="+t;l&&(e+=l)}return e};c.decorateURIWithRealm=function(e){e=c.decorateURIWithSubRealm(e);e=c.decorateURLWithOverrideRealm(e);return e};c.decorateURIWithSubRealm=function(e){var t=i.default.globalData,a=t&&t.auth?t.auth.subRealm:"",n=a?a+"/":"";t&&t.auth&&(void 0===t.auth.subRealm||null===t.auth.subRealm)&&console.warn("Unable to decorate URI, Configuration.globalData.auth.subRealm not yet set");e=e.replace("__subrealm__/",n);return e};c.getRealm=function(){var e=c.getOverrideRealm()||c.getSubRealm();return"/"===e.substring(0,1)?e.substring(1):e};c.getOverrideRealm=function(){var e=o.default.parseQueryString(o.default.getCurrentQueryString()).realm,t=o.default.parseQueryString(o.default.getCurrentFragmentQueryString()).realm;return e||t};c.getSubRealm=function(){var e=o.default.getCurrentFragment().split("/"),t=e.shift().split("&")[0],a=["login","passwordReset","continuePasswordReset","register","continueRegister"],n;if(t&&l.default.includes(a,t)){n=e.join("/").split("&")[0];n="/"===n.slice(-1)?n.slice(0,-1):n}else n=i.default.globalData.auth.subRealm?i.default.globalData.auth.subRealm:"";return n};c.encodeRealm=function(e){var t=[],a=e.split("/");l.default.each(a,function(e){""!==e&&t.push(encodeURIComponent(e))});return"/"+t.join("/")};t.default=c},1555:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=a(37);var l=d(n);var r=a(1578);var i=d(r);var s=a(27);var o=d(s);var u=a(1550);var c=d(u);function d(e){return e&&e.__esModule?e:{default:e}}t.default={substitute:function e(t){return function(){var e=i.default.getCurrentRealm(),a=""+o.default.host+o.default.context+"/json"+("/"===e?"":c.default.encodeRealm(e));return t.replace("__api__",a).replace("__host__",o.default.host).replace("__context__",o.default.context).replace("__username__",l.default.loggedUser.get("username"))}}}},1570:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=a(6);var l=h(n);var r=a(19);var i=h(r);var s=a(27);var o=h(s);var u=a(59);var c=h(u);var d=a(560);var f=h(d);function h(e){return e&&e.__esModule?e:{default:e}}var p={};function m(e){return l.default.has(e,"responseJSON.message")&&l.default.isString(e.responseJSON.message)}p.errorHandler=function(e){401===l.default.get(e,"status")?c.default.sendEvent(o.default.EVENT_UNAUTHORIZED,{error:e.error()}):m(e)?f.default.addMessage({type:f.default.TYPE_DANGER,escape:true,response:e}):f.default.addMessage({type:f.default.TYPE_DANGER,message:i.default.t("config.messages.CommonMessages.unknown")})};t.default=p},1578:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=a(63);var l=r(n);function r(e){return e&&e.__esModule?e:{default:e}}t.default={getCurrentRealm:function e(){return decodeURIComponent(l.default.getCurrentFragment().split("/")[1])}}},1624:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=a(169);var l=u(n);var r=a(27);var i=u(r);var s=a(168);var o=u(s);function u(e){return e&&e.__esModule?e:{default:e}}var c=new l.default(""+i.default.host+i.default.context+"/json");c.scripts={getAllDefault:function e(t){return c.serviceCall({url:(0,o.default)('/scripts?_pageSize=10&_sortKeys=name&_queryFilter=default eq true and context eq "'+t+'"&_pagedResultsOffset=0',{realm:false}),headers:{"Accept-API-Version":"protocol=1.0,resource=1.0"}})},getAllContexts:function e(){return c.serviceCall({url:(0,o.default)("/global-config/services/scripting/contexts?_queryFilter=true",{realm:false}),headers:{"Accept-API-Version":"protocol=1.0,resource=1.0"}})},getDefaultGlobalContext:function e(){return c.serviceCall({url:(0,o.default)("/global-config/services/scripting",{realm:false}),headers:{"Accept-API-Version":"protocol=1.0,resource=1.0"}})},getSchema:function e(){return c.serviceCall({url:(0,o.default)("/global-config/services/scripting?_action=schema",{realm:false}),headers:{"Accept-API-Version":"protocol=1.0,resource=1.0"},type:"POST"})},getContextSchema:function e(){return c.serviceCall({url:(0,o.default)("/global-config/services/scripting/contexts?_action=schema",{realm:false}),headers:{"Accept-API-Version":"protocol=1.0,resource=1.0"},type:"POST"})}};t.default=c},1631:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n={},l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r=[],i=64,s;for(s=0;s<256;s++)r.push(-1);for(s=0;s<l.length;s++)r[l.charCodeAt(s)]=s;r["=".charCodeAt(0)]=0;n.encodeUTF8=function(e){var t=unescape(encodeURIComponent(e)),a=t.length,n=[],r,s,o,u,c,d,f,h;if("function"===typeof btoa)return btoa(t);for(r=0;r<a;){s=t.charCodeAt(r++);o=t.charCodeAt(r++);u=t.charCodeAt(r++);c=s>>>2;d=(3&s)<<4|o>>>4;f=isNaN(o)?i:(15&o)<<2|u>>>6;h=isNaN(o)||isNaN(u)?i:63&u;n.push(l.charAt(c));n.push(l.charAt(d));n.push(l.charAt(f));n.push(l.charAt(h))}return n.join("")};n.decodeUTF8=function(e){var t=[],a=e.length,n,l,i,s,o,u,c,d;if("function"===typeof atob)t=atob(e);else{for(n=0;n<a;){l=r[e.charCodeAt(n++)];i=r[e.charCodeAt(n++)];s=r[e.charCodeAt(n++)];o=r[e.charCodeAt(n++)];u=l<<2|i>>>4;c=(15&i)<<4|s>>>2;d=(3&s)<<6|o;t.push(String.fromCharCode(u));0!==c&&t.push(String.fromCharCode(c));0!==d&&t.push(String.fromCharCode(d))}t=t.join("")}return decodeURIComponent(escape(t))};t.default=n},1653:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=a(159);var l=d(n);var r=a(1631);var i=d(r);var s=a(1555);var o=d(s);var u=a(1570);var c=d(u);function d(e){return e&&e.__esModule?e:{default:e}}t.default=l.default.Model.extend({idAttribute:"_id",urlRoot:o.default.substitute("__api__/scripts"),defaults:function e(){return{_id:null,name:"",script:"",language:"",context:""}},validate:function e(t){if(""===t.name.trim())return"scriptErrorNoName";if(""===t.language)return"scriptErrorNoLanguage"},parse:function e(t){t&&t.script&&(t.script=i.default.decodeUTF8(t.script));return t},sync:function e(t,a,n){n=n||{};n.beforeSend=function(e){e.setRequestHeader("Accept-API-Version","protocol=1.0,resource=1.0")};n.error=c.default.errorHandler;t=t.toLowerCase();"create"!==t&&null!==a.id||(n.url=this.urlRoot()+"/?_action=create");"create"!==t&&"update"!==t||a.set("script",i.default.encodeUTF8(a.get("script")));return l.default.Model.prototype.sync.call(this,t,a,n)}})},1824:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=a(169);var l=d(n);var r=a(27);var i=d(r);var s=a(168);var o=d(s);var u=a(560);var c=d(u);function d(e){return e&&e.__esModule?e:{default:e}}var f=new l.default(""+i.default.host+i.default.context+"/json");function h(e){c.default.addMessage({type:c.default.TYPE_DANGER,response:e})}f.validateScript=function(e){return f.serviceCall({url:(0,o.default)("/scripts/?_action=validate",{realm:false}),headers:{"Accept-API-Version":"protocol=1.0,resource=1.0"},type:"POST",data:JSON.stringify(e),error:h})};t.default=f},880:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){var a=[];var n=true;var l=false;var r=void 0;try{for(var i=e[Symbol.iterator](),s;!(n=(s=i.next()).done);n=true){a.push(s.value);if(t&&a.length===t)break}}catch(e){l=true;r=e}finally{try{!n&&i["return"]&&i["return"]()}finally{if(l)throw r}}return a}return function(t,a){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();a(1827);a(1826);a(1825);a(1531);var l=a(6);var r=W(l);var i=a(19);var s=W(i);var o=a(1630);var u=W(o);var c=a(114);var d=W(c);var f=a(1168);var h=W(f);var p=a(1631);var m=W(p);var v=a(655);var g=W(v);var b=a(1208);var x=W(b);var y=a(879);var _=W(y);var C=a(27);var S=W(C);var E=a(1207);var A=W(E);var R=a(59);var w=W(R);var P=a(1533);var M=W(P);var k=a(1624);var T=W(k);var N=a(560);var O=W(N);var D=a(1206);var F=W(D);var U=a(1824);var I=W(U);var q=a(73);var j=W(q);var L=a(1653);var V=W(L);var G=a(1205);var B=W(G);function W(e){return e&&e.__esModule?e:{default:e}}t.default=d.default.extend({initialize:function e(){d.default.prototype.initialize.call(this);this.model=null},partials:{"alerts/_Alert":h.default},events:{"click [data-upload-script]":"uploadScript","change [name=upload]":"readUploadedFile","click [data-validation-script]":"validateScript","click [data-change-context]":"openDialog","change input[name=language]":"onChangeLanguage","click [data-save]":"submitForm","click [data-delete]":"onDeleteClick","click [data-show-fullscreen]":"editFullScreen","click [data-exit-fullscreen]":"exitFullScreen","change [data-field]":"checkChanges","keyup [data-field]":"checkChanges"},render:function e(t,a){var n=null;this.data.realmPath=t[0];a&&(this.renderCallback=a);2===t.length&&(n=t[1]);this.contextsPromise=T.default.scripts.getAllContexts();this.defaultContextPromise=T.default.scripts.getDefaultGlobalContext();this.contextSchemaPromise=T.default.scripts.getSchema();this.languageSchemaPromise=T.default.scripts.getContextSchema();if(n){this.data.headerActions=[{actionPartial:"form/_Button",data:"delete",title:"common.form.delete",icon:"fa-times"}];this.template=A.default;this.model=new V.default({_id:n});this.listenTo(this.model,"sync",this.renderAfterSyncModel);this.model.fetch()}else{this.template=F.default;this.newEntity=true;this.model=new V.default;this.renderAfterSyncModel()}},renderAfterSyncModel:function e(){var t=this;this.data.entity=r.default.pick(this.model.attributes,"uuid","name","description","language","context","script");this.data.contexts?t.languageSchemaPromise.then(function(e){t.langSchema=e;t.renderScript()}):Promise.all([t.contextsPromise,t.defaultContextPromise,t.contextSchemaPromise,t.languageSchemaPromise]).then(function(e){var a=n(e,4),l=a[0],r=a[1],i=a[2],s=a[3];t.data.contexts=l.result;t.data.defaultContext=r.defaultContext;t.addContextNames(t.data.contexts,i);t.langSchema=s;t.renderScript()});t.cleanupAfterCodemirror=r.default.bind(t.cleanupAfterCodemirror,t);window.addEventListener("hashchange",t.cleanupAfterCodemirror)},cleanupAfterCodemirror:function e(){if(this.scriptEditor){this.scriptEditor.setOption("fullScreen",false);window.removeEventListener("hashchange",this.cleanupAfterCodemirror)}},renderScript:function e(){var t=this,a;if(this.model.id){a=r.default.find(this.data.contexts,function(e){return e._id===t.data.entity.context});this.data.contextName=a.name;this.data.languages=this.addLanguageNames(a.languages)}else this.data.languages=[];this.parentRender(function(){if(this.newEntity)this.$el.find("#context").selectize();else{this.changesPendingWidget=_.default.watchChanges({element:this.$el.find(".script-changes-pending"),watchedObj:this.data.entity,undo:!this.newEntity,undoCallback:function e(a){r.default.extend(t.data.entity,a);var n=r.default.find(t.data.contexts,{_id:t.data.entity.context});t.data.contextName=n.name;t.data.languages=t.addLanguageNames(n.languages);t.reRenderView()},alertClass:"alert-warning alert-sm"});this.showUploadButton();this.initScriptEditor()}this.renderCallback&&this.renderCallback()})},reRenderView:function e(){this.parentRender(function(){this.showUploadButton();this.initScriptEditor();this.changesPendingWidget.makeChanges(this.data.entity);this.changesPendingWidget.reRender(this.$el.find(".script-changes-pending"))})},checkChanges:function e(){this.updateFields();this.newEntity?this.toggleSaveButton(this.checkRequiredFields()):this.changesPendingWidget.makeChanges(this.data.entity)},updateFields:function e(){var t=this,a=this.data.entity,n=a.context,l=this.$el.find("[data-field]"),i;r.default.each(l,function(e){i=e.getAttribute("data-field");"radio"===e.type?e.checked&&(a[i]=e.value):a[i]=e.value.trim()});if(this.newEntity){if(n!==a.context){t.toggleSaveButton(false);this.changeContext().then(function(){t.toggleSaveButton(t.checkRequiredFields())})}}else a.script=this.scriptEditor.getValue()},checkRequiredFields:function e(){return this.data.entity.name&&this.data.entity.context&&this.data.entity.language},submitForm:function e(t){t.preventDefault();var a=this,n,l=r.default.clone(this.model.attributes);this.updateFields();r.default.extend(this.model.attributes,{description:""},this.data.entity);n=this.model.save();if(n)n.then(function(){a.newEntity?j.default.routeTo(j.default.configuration.routes.realmsScriptEdit,{args:[encodeURIComponent(a.data.realmPath),a.model.id],trigger:true}):w.default.sendEvent(S.default.EVENT_DISPLAY_MESSAGE_REQUEST,"changesSaved")});else{r.default.extend(this.model.attributes,l);w.default.sendEvent(S.default.EVENT_DISPLAY_MESSAGE_REQUEST,this.model.validationError)}},validateScript:function e(){var t=this.scriptEditor.getValue(),a=this.data.entity.language,n,l=this;n={script:m.default.encodeUTF8(t),language:a};I.default.validateScript(n).then(function(e){var t=(0,B.default)(e);l.$el.find("#validation").html(t)},function(e){O.default.addMessage({type:O.default.TYPE_DANGER,response:e})})},uploadScript:function e(){this.$el.find("[name=upload]").trigger("click")},readUploadedFile:function e(t){var a=this,n=t.target.files[0],l=new FileReader;l.onload=function(){return function(e){a.scriptEditor.setValue(e.target.result)}}(n);l.readAsText(n)},openDialog:function e(){var t=this;this.data.defaultContext?t.renderDialog():this.defaultContextPromise.then(function(e){t.data.defaultContext=e.defaultContext;t.renderDialog()})},renderDialog:function e(){g.default.show(this.constructDialogOptions())},constructDialogOptions:function e(){var t=this,a=[],n={type:g.default.TYPE_DANGER,title:s.default.t("console.scripts.edit.dialog.title"),cssClass:"script-change-context",message:(0,s.default)("<div></div>"),onshow:function e(){var a=this;var n=(0,x.default)(t.data);a.message.append(n)}};a.push({label:s.default.t("common.form.cancel"),cssClass:"btn-default",action:function e(t){t.close()}},{label:s.default.t("common.form.change"),cssClass:"btn-danger",action:function e(a){var n=a.$modalContent.find("[name=changeContext]:checked"),l=n.val(),i=n.parent().text().trim();if(t.data.entity.context!==l){t.data.entity.context=l;t.data.contextName=i;t.changeContext().then(r.default.bind(t.reRenderView,t))}a.close()}});n.buttons=a;return n},changeContext:function e(){var t=this,a=r.default.find(this.data.contexts,function(e){return e._id===t.data.entity.context}),n,l=s.default.Deferred();this.data.languages=this.addLanguageNames(a.languages);if("[Empty]"===a.defaultScript){this.data.entity.script="";1===this.data.languages.length?this.data.entity.language=this.data.languages[0].id:this.data.entity.language="";l.resolve()}else{n=new V.default({_id:a.defaultScript});this.listenTo(n,"sync",function(e){1===t.data.languages.length?t.data.entity.language=t.data.languages[0].id:t.data.entity.language=e.attributes.language;t.data.entity.script=e.attributes.script;l.resolve()});n.fetch()}return l},initScriptEditor:function e(){this.scriptEditor=u.default.fromTextArea(this.$el.find("#script")[0],{lineNumbers:true,autofocus:true,viewportMargin:Infinity,mode:this.data.entity.language.toLowerCase(),theme:"forgerock"});this.scriptEditor.on("update",r.default.bind(this.checkChanges,this))},onChangeLanguage:function e(t){this.changeLanguage(t.target.value)},changeLanguage:function e(t){this.data.entity.language=t;this.scriptEditor.setOption("mode",t.toLowerCase())},showUploadButton:function e(){window.File&&window.FileReader&&window.FileList&&this.$el.find("[data-upload-scripts]").show()},addContextNames:function e(t,a){var n,l,i=t.length;if(a&&a.properties&&a.properties.defaultContext)for(n=0;n<i;n++){l=r.default.indexOf(a.properties.defaultContext["enum"],t[n]._id);t[n].name=a.properties.defaultContext.options.enum_titles[l]}},addLanguageNames:function e(t){var a,n,l=t.length,i;if(this.langSchema&&this.langSchema.properties&&this.langSchema.properties.languages&&this.langSchema.properties.languages.items){a=[];for(n=0;n<l;n++){i=r.default.indexOf(this.langSchema.properties.languages.items["enum"],t[n]);a[n]={id:t[n],name:this.langSchema.properties.languages.items.options.enum_titles[i]}}}return a},onDeleteClick:function e(t){t.preventDefault();M.default.showConfirmationBeforeDeleting({type:s.default.t("console.scripts.edit.script")},r.default.bind(this.deleteScript,this))},deleteScript:function e(){var t=this,a=function e(){j.default.routeTo(j.default.configuration.routes.realmsScripts,{args:[encodeURIComponent(t.data.realmPath)],trigger:true});w.default.sendEvent(S.default.EVENT_DISPLAY_MESSAGE_REQUEST,"changesSaved")};this.model.destroy({success:a,wait:true})},editFullScreen:function e(){this.toggleFullScreen(true)},exitFullScreen:function e(){this.toggleFullScreen(false)},toggleFullScreen:function e(t){this.scriptEditor.setOption("fullScreen",t);this.$el.find(".full-screen-bar").toggle(t)},toggleSaveButton:function e(t){this.$el.find("[data-save]").prop("disabled",!t)}})}}]);
//# sourceMappingURL=24.194df19e7b.js.map