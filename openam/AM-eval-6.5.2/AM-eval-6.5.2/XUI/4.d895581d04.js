(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{1562:function(e,t,i){var r,n;
/*!
  backgrid 0.3.8
  http://github.com/cloudflare/backgrid

  Copyright (c) 2017 Cloudflare, Inc. and contributors <jwong@cloudflare.com>
  Licensed under the MIT license.
*/
/*!
  backgrid 0.3.8
  http://github.com/cloudflare/backgrid

  Copyright (c) 2017 Cloudflare, Inc. and contributors <jwong@cloudflare.com>
  Licensed under the MIT license.
*/
(function(s,o){true;!(r=[i(181),i(159)],n=function(e,t){return s.Backgrid=o(e,t)}.apply(t,r),void 0!==n&&(e.exports=n))})(this,function(e,t){"use strict";var i="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff";if(!String.prototype.trim||i.trim()){i="["+i+"]";var r=new RegExp("^"+i+i+"*"),n=new RegExp(i+i+"*$");String.prototype.trim=function e(){if(void 0===this||null===this)throw new TypeError("can't convert "+this+" to object");return String(this).replace(r,"").replace(n,"")}}function s(e,t,i){var r=t-(e+"").length;r=r<0?0:r;var n="";for(var s=0;s<r;s++)n+=i;return n+e}var o=t.$;var l={Extension:{},resolveNameToClass:function(t,i){if(e.isString(t)){var r=e.map(t.split("-"),function(e){return e.slice(0,1).toUpperCase()+e.slice(1)}).join("")+i;var n=l[r]||l.Extension[r];if(e.isUndefined(n))throw new ReferenceError("Class '"+r+"' not found");return n}return t},callByNeed:function(){var t=arguments[0];if(!e.isFunction(t))return t;var i=arguments[1];var r=[].slice.call(arguments,2);return t.apply(i,!(r+"")?[]:r)}};e.extend(l,t.Events);var a=l.Command=function(t){e.extend(this,{altKey:!!t.altKey,char:t["char"],charCode:t.charCode,ctrlKey:!!t.ctrlKey,key:t.key,keyCode:t.keyCode,locale:t.locale,location:t.location,metaKey:!!t.metaKey,repeat:!!t.repeat,shiftKey:!!t.shiftKey,which:t.which})};e.extend(a.prototype,{moveUp:function(){return 38==this.keyCode},moveDown:function(){return 40===this.keyCode},moveLeft:function(){return this.shiftKey&&9===this.keyCode},moveRight:function(){return!this.shiftKey&&9===this.keyCode},save:function(){return 13===this.keyCode},cancel:function(){return 27===this.keyCode},passThru:function(){return!(this.moveUp()||this.moveDown()||this.moveLeft()||this.moveRight()||this.save()||this.cancel())}});var h=l.CellFormatter=function(){};e.extend(h.prototype,{fromRaw:function(e,t){return e},toRaw:function(e,t){return e}});var c=l.NumberFormatter=function(t){e.extend(this,this.defaults,t||{});if(this.decimals<0||this.decimals>20)throw new RangeError("decimals must be between 0 and 20")};c.prototype=new h;e.extend(c.prototype,{defaults:{decimals:2,decimalSeparator:".",orderSeparator:","},HUMANIZED_NUM_RE:/(\d)(?=(?:\d{3})+$)/g,fromRaw:function(t,i){if(e.isNull(t)||e.isUndefined(t))return"";t=parseFloat(t).toFixed(~~this.decimals);var r=t.split(".");var n=r[0];var s=r[1]?(this.decimalSeparator||".")+r[1]:"";return n.replace(this.HUMANIZED_NUM_RE,"$1"+this.orderSeparator)+s},toRaw:function(t,i){t=t.trim();if(""===t)return null;var r="";var n=t.split(this.orderSeparator);for(var s=0;s<n.length;s++)r+=n[s];var o=r.split(this.decimalSeparator);r="";for(var s=0;s<o.length;s++)r=r+o[s]+".";"."===r[r.length-1]&&(r=r.slice(0,r.length-1));var l=1*(1*r).toFixed(~~this.decimals);if(e.isNumber(l)&&!e.isNaN(l))return l}});var u=l.PercentFormatter=function(){l.NumberFormatter.apply(this,arguments)};u.prototype=new l.NumberFormatter,e.extend(u.prototype,{defaults:e.extend({},c.prototype.defaults,{multiplier:1,symbol:"%"}),fromRaw:function(e,t){var i=[].slice.call(arguments,1);i.unshift(e*this.multiplier);return(c.prototype.fromRaw.apply(this,i)||"0")+this.symbol},toRaw:function(t,i){var r=t.split(this.symbol);if(r&&r[0]&&""===r[1]||null==r[1]){var n=c.prototype.toRaw.call(this,r[0]);if(e.isUndefined(n))return n;return n/this.multiplier}}});var d=l.DatetimeFormatter=function(t){e.extend(this,this.defaults,t||{});if(!this.includeDate&&!this.includeTime)throw new Error("Either includeDate or includeTime must be true")};d.prototype=new h;e.extend(d.prototype,{defaults:{includeDate:true,includeTime:true,includeMilli:false},DATE_RE:/^([+\-]?\d{4})-(\d{2})-(\d{2})$/,TIME_RE:/^(\d{2}):(\d{2}):(\d{2})(\.(\d{3}))?$/,ISO_SPLITTER_RE:/T|Z| +/,_convert:function(t,i){if(""===(t+"").trim())return null;var r,n=null;if(e.isNumber(t)){var o=new Date(t);r=s(o.getUTCFullYear(),4,0)+"-"+s(o.getUTCMonth()+1,2,0)+"-"+s(o.getUTCDate(),2,0);n=s(o.getUTCHours(),2,0)+":"+s(o.getUTCMinutes(),2,0)+":"+s(o.getUTCSeconds(),2,0)}else{t=t.trim();var l=t.split(this.ISO_SPLITTER_RE)||[];r=this.DATE_RE.test(l[0])?l[0]:"";n=r&&l[1]?l[1]:this.TIME_RE.test(l[0])?l[0]:""}var a=this.DATE_RE.exec(r)||[];var h=this.TIME_RE.exec(n)||[];if(i){if(this.includeDate&&e.isUndefined(a[0]))return;if(this.includeTime&&e.isUndefined(h[0]))return;if(!this.includeDate&&r)return;if(!this.includeTime&&n)return}var o=new Date(Date.UTC(1*a[1]||0,1*a[2]-1||0,1*a[3]||0,1*h[1]||null,1*h[2]||null,1*h[3]||null,1*h[5]||null));var c="";this.includeDate&&(c=s(o.getUTCFullYear(),4,0)+"-"+s(o.getUTCMonth()+1,2,0)+"-"+s(o.getUTCDate(),2,0));if(this.includeTime){c=c+(this.includeDate?"T":"")+s(o.getUTCHours(),2,0)+":"+s(o.getUTCMinutes(),2,0)+":"+s(o.getUTCSeconds(),2,0);this.includeMilli&&(c=c+"."+s(o.getUTCMilliseconds(),3,0))}this.includeDate&&this.includeTime&&(c+="Z");return c},fromRaw:function(t,i){if(e.isNull(t)||e.isUndefined(t))return"";return this._convert(t)},toRaw:function(e,t){return this._convert(e,true)}});var m=l.StringFormatter=function(){};m.prototype=new h;e.extend(m.prototype,{fromRaw:function(t,i){if(e.isUndefined(t)||e.isNull(t))return"";return t+""}});var p=l.EmailFormatter=function(){};p.prototype=new h;e.extend(p.prototype,{toRaw:function(t,i){var r=t.trim().split("@");if(2===r.length&&e.all(r))return t}});var f=l.SelectFormatter=function(){};f.prototype=new h;e.extend(f.prototype,{fromRaw:function(t,i){return e.isArray(t)?t:null!=t?[t]:[]}});var v=l.CellEditor=t.View.extend({initialize:function(e){this.formatter=e.formatter;this.column=e.column;this.column instanceof M||(this.column=new M(this.column));this.listenTo(this.model,"backgrid:editing",this.postRender)},postRender:function(e,t){null!=t&&t.get("name")!=this.column.get("name")||this.$el.focus();return this}});var g=l.InputCellEditor=v.extend({tagName:"input",attributes:{type:"text"},events:{blur:"saveOrCancel",keydown:"saveOrCancel"},initialize:function(e){g.__super__.initialize.apply(this,arguments);e.placeholder&&this.$el.attr("placeholder",e.placeholder)},render:function(){var e=this.model;this.$el.val(this.formatter.fromRaw(e.get(this.column.get("name")),e));return this},saveOrCancel:function(t){var i=this.formatter;var r=this.model;var n=this.column;var s=new a(t);var o="blur"===t.type;if(s.moveUp()||s.moveDown()||s.moveLeft()||s.moveRight()||s.save()||o){t.preventDefault();t.stopPropagation();var l=this.$el.val();var h=i.toRaw(l,r);if(e.isUndefined(h))r.trigger("backgrid:error",r,n,l);else{r.set(n.get("name"),h);r.trigger("backgrid:edited",r,n,s)}}else if(s.cancel()){t.stopPropagation();r.trigger("backgrid:edited",r,n,s)}},postRender:function(e,t){if(null==t||t.get("name")==this.column.get("name"))if("right"===this.$el.css("text-align")){var i=this.$el.val();this.$el.focus().val(null).val(i)}else this.$el.focus();return this}});var y=l.Cell=t.View.extend({tagName:"td",formatter:h,editor:g,events:{click:"enterEditMode"},initialize:function(t){this.column=t.column;this.column instanceof M||(this.column=new M(this.column));var i=this.column,r=this.model,n=this.$el;var s=l.resolveNameToClass(i.get("formatter")||this.formatter,"Formatter");e.isFunction(s.fromRaw)||e.isFunction(s.toRaw)||(s=new s);this.formatter=s;this.editor=l.resolveNameToClass(this.editor,"CellEditor");this.listenTo(r,"change:"+i.get("name"),function(){n.hasClass("editor")||this.render()});this.listenTo(r,"backgrid:error",this.renderError);this.listenTo(i,"change:editable change:sortable change:renderable",function(e){var t=e.changedAttributes();for(var i in t)t.hasOwnProperty(i)&&n.toggleClass(i,t[i])});this.updateStateClassesMaybe()},updateStateClassesMaybe:function(){var e=this.model;var t=this.column;var i=this.$el;i.toggleClass("editable",l.callByNeed(t.editable(),t,e));i.toggleClass("sortable",l.callByNeed(t.sortable(),t,e));i.toggleClass("renderable",l.callByNeed(t.renderable(),t,e))},render:function(){var e=this.$el;e.empty();var t=this.model;var i=this.column.get("name");e.text(this.formatter.fromRaw(t.get(i),t));e.addClass(i);this.updateStateClassesMaybe();this.delegateEvents();return this},enterEditMode:function(){var e=this.model;var t=this.column;var i=l.callByNeed(t.editable(),t,e);if(i){this.currentEditor=new this.editor({column:this.column,model:this.model,formatter:this.formatter});e.trigger("backgrid:edit",e,t,this,this.currentEditor);this.undelegateEvents();this.$el.empty();this.$el.append(this.currentEditor.$el);this.currentEditor.render();this.$el.addClass("editor");e.trigger("backgrid:editing",e,t,this,this.currentEditor)}},renderError:function(e,t){null!=t&&t.get("name")!=this.column.get("name")||this.$el.addClass("error")},exitEditMode:function(){this.$el.removeClass("error");this.currentEditor.remove();this.stopListening(this.currentEditor);delete this.currentEditor;this.$el.removeClass("editor");this.render()},remove:function(){if(this.currentEditor){this.currentEditor.remove.apply(this.currentEditor,arguments);delete this.currentEditor}return y.__super__.remove.apply(this,arguments)}});var w=l.StringCell=y.extend({className:"string-cell",formatter:m});var b=l.UriCell=y.extend({className:"uri-cell",title:null,target:"_blank",initialize:function(e){b.__super__.initialize.apply(this,arguments);this.title=e.title||this.title;this.target=e.target||this.target},render:function(){this.$el.empty();var e=this.model.get(this.column.get("name"));var t=this.formatter.fromRaw(e,this.model);this.$el.append(o("<a>",{tabIndex:-1,href:e,title:this.title||t,target:this.target}).text(t));this.delegateEvents();return this}});var C=l.EmailCell=w.extend({className:"email-cell",formatter:p,render:function(){this.$el.empty();var e=this.model;var t=this.formatter.fromRaw(e.get(this.column.get("name")),e);this.$el.append(o("<a>",{tabIndex:-1,href:"mailto:"+t,title:t}).text(t));this.delegateEvents();return this}});var x=l.NumberCell=y.extend({className:"number-cell",decimals:c.prototype.defaults.decimals,decimalSeparator:c.prototype.defaults.decimalSeparator,orderSeparator:c.prototype.defaults.orderSeparator,formatter:c,initialize:function(e){x.__super__.initialize.apply(this,arguments);var t=this.formatter;t.decimals=this.decimals;t.decimalSeparator=this.decimalSeparator;t.orderSeparator=this.orderSeparator}});var E=l.IntegerCell=x.extend({className:"integer-cell",decimals:0});var T=l.PercentCell=x.extend({className:"percent-cell",multiplier:u.prototype.defaults.multiplier,symbol:u.prototype.defaults.symbol,formatter:u,initialize:function(){T.__super__.initialize.apply(this,arguments);var e=this.formatter;e.multiplier=this.multiplier;e.symbol=this.symbol}});var R=l.DatetimeCell=y.extend({className:"datetime-cell",includeDate:d.prototype.defaults.includeDate,includeTime:d.prototype.defaults.includeTime,includeMilli:d.prototype.defaults.includeMilli,formatter:d,initialize:function(t){R.__super__.initialize.apply(this,arguments);var i=this.formatter;i.includeDate=this.includeDate;i.includeTime=this.includeTime;i.includeMilli=this.includeMilli;var r=this.includeDate?"YYYY-MM-DD":"";r+=this.includeDate&&this.includeTime?"T":"";r+=this.includeTime?"HH:mm:ss":"";r+=this.includeTime&&this.includeMilli?".SSS":"";this.editor=this.editor.extend({attributes:e.extend({},this.editor.prototype.attributes,this.editor.attributes,{placeholder:r})})}});var k=l.DateCell=R.extend({className:"date-cell",includeTime:false});var $=l.TimeCell=R.extend({className:"time-cell",includeDate:false});var N=l.BooleanCellEditor=v.extend({tagName:"input",attributes:{tabIndex:-1,type:"checkbox"},events:{mousedown:function(){this.mouseDown=true},blur:"enterOrExitEditMode",mouseup:function(){this.mouseDown=false},change:"saveOrCancel",keydown:"saveOrCancel"},render:function(){var e=this.model;var t=this.formatter.fromRaw(e.get(this.column.get("name")),e);this.$el.prop("checked",t);return this},enterOrExitEditMode:function(e){if(!this.mouseDown){var t=this.model;t.trigger("backgrid:edited",t,this.column,new a(e))}},saveOrCancel:function(e){var t=this.model;var i=this.column;var r=this.formatter;var n=new a(e);if(n.passThru()&&"change"!=e.type)return true;if(n.cancel()){e.stopPropagation();t.trigger("backgrid:edited",t,i,n)}var s=this.$el;if(n.save()||n.moveLeft()||n.moveRight()||n.moveUp()||n.moveDown()){e.preventDefault();e.stopPropagation();var o=r.toRaw(s.prop("checked"),t);t.set(i.get("name"),o);t.trigger("backgrid:edited",t,i,n)}else if("change"==e.type){var o=r.toRaw(s.prop("checked"),t);t.set(i.get("name"),o);s.focus()}}});var _=l.BooleanCell=y.extend({className:"boolean-cell",editor:N,events:{click:"enterEditMode"},render:function(){this.$el.empty();var e=this.model,t=this.column;var i=l.callByNeed(t.editable(),t,e);this.$el.append(o("<input>",{tabIndex:-1,type:"checkbox",checked:this.formatter.fromRaw(e.get(t.get("name")),e),disabled:!i}));this.delegateEvents();return this}});var S=l.SelectCellEditor=v.extend({tagName:"select",events:{change:"save",blur:"close",keydown:"close"},template:e.template('<option value="<%- value %>" <%= selected ? \'selected="selected"\' : "" %>><%- text %></option>',null,{variable:null,evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g}),setOptionValues:function(t){this.optionValues=t;this.optionValues=e.result(this,"optionValues")},setMultiple:function(e){this.multiple=e;this.$el.prop("multiple",e)},_renderOptions:function(t,i){var r="";for(var n=0;n<t.length;n++)r+=this.template({text:t[n][0],value:t[n][1],selected:e.indexOf(i,t[n][1])>-1});return r},render:function(){this.$el.empty();var t=e.result(this,"optionValues");var i=this.model;var r=this.formatter.fromRaw(i.get(this.column.get("name")),i);if(!e.isArray(t))throw new TypeError("optionValues must be an array");var n=null;var s=null;var n=null;var l=null;var a=null;for(var h=0;h<t.length;h++){var n=t[h];if(e.isArray(n)){s=n[0];n=n[1];this.$el.append(this.template({text:s,value:n,selected:e.indexOf(r,n)>-1}))}else{if(!e.isObject(n))throw new TypeError("optionValues elements must be a name-value pair or an object hash of { name: 'optgroup label', value: [option name-value pairs] }");l=n.name;a=o("<optgroup></optgroup>",{label:l});a.append(this._renderOptions.call(this,n.values,r));this.$el.append(a)}}this.delegateEvents();return this},save:function(e){var t=this.model;var i=this.column;t.set(i.get("name"),this.formatter.toRaw(this.$el.val(),t))},close:function(e){var t=this.model;var i=this.column;var r=new a(e);if(r.cancel()){e.stopPropagation();t.trigger("backgrid:edited",t,i,new a(e))}else if(r.save()||r.moveLeft()||r.moveRight()||r.moveUp()||r.moveDown()||"blur"==e.type){e.preventDefault();e.stopPropagation();this.save(e);t.trigger("backgrid:edited",t,i,new a(e))}}});var D=l.SelectCell=y.extend({className:"select-cell",editor:S,multiple:false,formatter:f,optionValues:void 0,delimiter:", ",initialize:function(e){D.__super__.initialize.apply(this,arguments);this.listenTo(this.model,"backgrid:edit",function(e,t,i,r){if(t.get("name")==this.column.get("name")){r.setOptionValues(this.optionValues);r.setMultiple(this.multiple)}})},render:function(){this.$el.empty();var t=e.result(this,"optionValues");var i=this.model;var r=this.formatter.fromRaw(i.get(this.column.get("name")),i);var n=[];try{if(!e.isArray(t)||e.isEmpty(t))throw new TypeError;for(var s=0;s<r.length;s++){var o=r[s];for(var l=0;l<t.length;l++){var a=t[l];if(e.isArray(a)){var h=a[0];var a=a[1];a==o&&n.push(h)}else{if(!e.isObject(a))throw new TypeError;var c=a.values;for(var u=0;u<c.length;u++){var d=c[u];d[1]==o&&n.push(d[0])}}}}this.$el.append(n.join(this.delimiter))}catch(e){if(e instanceof TypeError)throw new TypeError("'optionValues' must be of type {Array.<Array>|Array.<{name: string, values: Array.<Array>}>}");throw e}this.delegateEvents();return this}});var M=l.Column=t.Model.extend({defaults:{name:void 0,label:void 0,sortable:true,editable:true,renderable:true,formatter:void 0,sortType:"cycle",sortValue:void 0,direction:null,cell:void 0,headerCell:void 0},initialize:function(){this.has("label")||this.set({label:this.get("name")},{silent:true});var e=l.resolveNameToClass(this.get("headerCell"),"HeaderCell");var t=l.resolveNameToClass(this.get("cell"),"Cell");this.set({cell:t,headerCell:e},{silent:true})},sortValue:function(){var t=this.get("sortValue");if(e.isString(t))return this[t];if(e.isFunction(t))return t;return function(e,t){return e.get(t)}}});e.each(["sortable","renderable","editable"],function(t){M.prototype[t]=function(){var i=this.get(t);if(e.isString(i))return this[i];if(e.isFunction(i))return i;return!!i}});var U=l.Columns=t.Collection.extend({model:M});var F=l.Row=t.View.extend({tagName:"tr",initialize:function(e){var i=this.columns=e.columns;i instanceof t.Collection||(i=this.columns=new U(i));var r=this.cells=[];for(var n=0;n<i.length;n++)r.push(this.makeCell(i.at(n),e));this.listenTo(i,"add",function(t,i){var n=i.indexOf(t);var s=this.makeCell(t,e);r.splice(n,0,s);var o=this.$el;0===n?o.prepend(s.render().$el):n===i.length-1?o.append(s.render().$el):o.children().eq(n).before(s.render().$el)});this.listenTo(i,"remove",function(e,t,i){r[i.index].remove();r.splice(i.index,1)})},makeCell:function(e){return new(e.get("cell"))({column:e,model:this.model})},render:function(){this.$el.empty();var e=document.createDocumentFragment();for(var t=0;t<this.cells.length;t++)e.appendChild(this.cells[t].render().el);this.el.appendChild(e);this.delegateEvents();return this},remove:function(){for(var e=0;e<this.cells.length;e++){var i=this.cells[e];i.remove.apply(i,arguments)}return t.View.prototype.remove.apply(this,arguments)}});var B=l.EmptyRow=t.View.extend({tagName:"tr",emptyText:null,initialize:function(e){this.emptyText=e.emptyText;this.columns=e.columns},render:function(){this.$el.empty();var t=document.createElement("td");t.setAttribute("colspan",this.columns.length);var i=document.createElement("span");i.innerHTML=e.result(this,"emptyText");t.appendChild(i);this.el.className="empty";this.el.appendChild(t);return this}});var V=l.HeaderCell=t.View.extend({tagName:"th",events:{"click button":"onClick"},initialize:function(e){this.column=e.column;this.column instanceof M||(this.column=new M(this.column));var t=this.column,i=this.collection,r=this.$el;this.listenTo(t,"change:editable change:sortable change:renderable",function(e){var t=e.changedAttributes();for(var i in t)t.hasOwnProperty(i)&&r.toggleClass(i,t[i])});this.listenTo(t,"change:direction",this.setCellDirection);this.listenTo(t,"change:name change:label",this.render);l.callByNeed(t.editable(),t,i)&&r.addClass("editable");l.callByNeed(t.sortable(),t,i)&&r.addClass("sortable");l.callByNeed(t.renderable(),t,i)&&r.addClass("renderable");this.listenTo(i.fullCollection||i,"backgrid:sorted",this.removeCellDirection)},removeCellDirection:function(){this.$el.removeClass("ascending").removeClass("descending");this.column.set("direction",null)},setCellDirection:function(e,t){this.$el.removeClass("ascending").removeClass("descending");e.cid==this.column.cid&&this.$el.addClass(t)},onClick:function(e){e.preventDefault();var t=this.column;var i=this.collection;var r="backgrid:sort";function n(e,n){"ascending"===t.get("direction")?i.trigger(r,n,"descending"):"descending"===t.get("direction")?i.trigger(r,n,null):i.trigger(r,n,"ascending")}function s(e,n){"ascending"===t.get("direction")?i.trigger(r,n,"descending"):i.trigger(r,n,"ascending")}var o=l.callByNeed(t.sortable(),t,this.collection);if(o){var a=t.get("sortType");"toggle"===a?s(this,t):n(this,t)}},render:function(){this.$el.empty();var e=this.column;var t=l.callByNeed(e.sortable(),e,this.collection);var i;i=t?o("<button>").text(e.get("label")).append("<span class='sort-caret' aria-hidden='true'></span>"):document.createTextNode(e.get("label"));this.$el.append(i);this.$el.addClass(e.get("name"));this.$el.addClass(e.get("direction"));this.delegateEvents();return this}});var z=l.HeaderRow=l.Row.extend({initialize:function(){l.Row.prototype.initialize.apply(this,arguments)},makeCell:function(e,t){var i=e.get("headerCell")||t.headerCell||V;i=new i({column:e,collection:this.collection});return i}});var O=l.Header=t.View.extend({tagName:"thead",initialize:function(e){this.columns=e.columns;this.columns instanceof t.Collection||(this.columns=new U(this.columns));this.row=new l.HeaderRow({columns:this.columns,collection:this.collection})},render:function(){this.$el.append(this.row.render().$el);this.delegateEvents();return this},remove:function(){this.row.remove.apply(this.row,arguments);return t.View.prototype.remove.apply(this,arguments)}});var P=l.Body=t.View.extend({tagName:"tbody",initialize:function(e){this.columns=e.columns;this.columns instanceof t.Collection||(this.columns=new U(this.columns));this.row=e.row||this.row||F;this.rows=this.collection.map(function(e){var t=new this.row({columns:this.columns,model:e});return t},this);this.emptyText=e.emptyText;this._unshiftEmptyRowMayBe();var i=this.collection;this.listenTo(i,"add",this.insertRow);this.listenTo(i,"remove",this.removeRow);this.listenTo(i,"sort",this.refresh);this.listenTo(i,"reset",this.refresh);this.listenTo(i,"backgrid:sort",this.sort);this.listenTo(i,"backgrid:edited",this.moveToNextCell);this.listenTo(this.columns,"add remove",this.updateEmptyRow)},_unshiftEmptyRowMayBe:function(){if(0===this.rows.length&&null!=this.emptyText){this.emptyRow=new B({emptyText:this.emptyText,columns:this.columns});this.rows.unshift(this.emptyRow);return true}},insertRow:function(e,i,r){this.rows[0]instanceof B&&this.rows.pop().remove();if(!(i instanceof t.Collection)&&!r){this.collection.add(e,r=i);return}var n=new this.row({columns:this.columns,model:e});var s=i.indexOf(e);this.rows.splice(s,0,n);var o=this.$el;var l=o.children();var a=n.render().$el;s>=l.length?o.append(a):l.eq(s).before(a);return this},removeRow:function(t,i,r){if(!r){this.collection.remove(t,r=i);this._unshiftEmptyRowMayBe()&&this.render();return}(e.isUndefined(r.render)||r.render)&&this.rows[r.index].remove();this.rows.splice(r.index,1);this._unshiftEmptyRowMayBe()&&this.render();return this},updateEmptyRow:function(){null!=this.emptyRow&&this.emptyRow.render()},refresh:function(){for(var e=0;e<this.rows.length;e++)this.rows[e].remove();this.rows=this.collection.map(function(e){var t=new this.row({columns:this.columns,model:e});return t},this);this._unshiftEmptyRowMayBe();this.render();this.collection.trigger("backgrid:refresh",this);return this},render:function(){this.$el.empty();var e=document.createDocumentFragment();for(var t=0;t<this.rows.length;t++){var i=this.rows[t];e.appendChild(i.render().el)}this.el.appendChild(e);this.delegateEvents();return this},remove:function(){for(var e=0;e<this.rows.length;e++){var i=this.rows[e];i.remove.apply(i,arguments)}return t.View.prototype.remove.apply(this,arguments)},sort:function(i,r){if(!e.contains(["ascending","descending",null],r))throw new RangeError('direction must be one of "ascending", "descending" or `null`');e.isString(i)&&(i=this.columns.findWhere({name:i}));var n=this.collection;var s;s="ascending"===r?-1:"descending"===r?1:null;var o=this.makeComparator(i.get("name"),s,s?i.sortValue():function(e){return 1*e.cid.replace("c","")});if(t.PageableCollection&&n instanceof t.PageableCollection){n.setSorting(s&&i.get("name"),s,{sortValue:i.sortValue()});if(n.fullCollection){null==n.fullCollection.comparator&&(n.fullCollection.comparator=o);n.fullCollection.sort();n.trigger("backgrid:sorted",i,r,n);i.set("direction",r)}else n.fetch({reset:true,success:function(){n.trigger("backgrid:sorted",i,r,n);i.set("direction",r)}})}else{n.comparator=o;n.sort();n.trigger("backgrid:sorted",i,r,n);i.set("direction",r)}return this},makeComparator:function(e,t,i){return function(r,n){var s=i(r,e),o=i(n,e),l;1===t&&(l=s,s=o,o=l);if(s===o)return 0;if(s<o)return-1;return 1}},moveToNextCell:function(e,t,i){var r=this.collection.indexOf(e);var n=this.columns.indexOf(t);var s,o,a,h,c;if(-1===n)return this;this.rows[r].cells[n].exitEditMode();if(i.moveUp()||i.moveDown()||i.moveLeft()||i.moveRight()||i.save()){var u=this.columns.length;var d=u*this.collection.length;if(i.moveUp()||i.moveDown()){h=r+(i.moveUp()?-1:1);var m=this.rows[h];if(m){s=m.cells[n];if(l.callByNeed(s.column.editable(),s.column,e)){s.enterEditMode();e.trigger("backgrid:next",h,n,false)}}else e.trigger("backgrid:next",h,n,true)}else if(i.moveLeft()||i.moveRight()){var p=i.moveRight();for(var f=r*u+n+(p?1:-1);f>=0&&f<d;p?f++:f--){h=~~(f/u);c=f-h*u;s=this.rows[h].cells[c];o=l.callByNeed(s.column.renderable(),s.column,s.model);a=l.callByNeed(s.column.editable(),s.column,e);if(o&&a){s.enterEditMode();e.trigger("backgrid:next",h,c,false);break}}f==d&&e.trigger("backgrid:next",~~(f/u),f-h*u,true)}}return this}});var I=l.Footer=t.View.extend({tagName:"tfoot",initialize:function(e){this.columns=e.columns;this.columns instanceof t.Collection||(this.columns=new l.Columns(this.columns))}});var A=l.Grid=t.View.extend({tagName:"table",className:"backgrid",header:O,body:P,footer:null,initialize:function(i){i.columns instanceof t.Collection||(i.columns=new U(i.columns||this.columns));this.columns=i.columns;this.caption=i.caption;var r=e.omit(i,["el","id","attributes","className","tagName","events"]);this.body=i.body||this.body;this.body=new this.body(r);this.header=i.header||this.header;this.header&&(this.header=new this.header(r));this.footer=i.footer||this.footer;this.footer&&(this.footer=new this.footer(r));this.listenTo(this.columns,"reset",function(){this.header&&(this.header=new(this.header.remove().constructor)(r));this.body=new(this.body.remove().constructor)(r);this.footer&&(this.footer=new(this.footer.remove().constructor)(r));this.render()})},insertRow:function(){this.body.insertRow.apply(this.body,arguments);return this},removeRow:function(){this.body.removeRow.apply(this.body,arguments);return this},insertColumn:function(){this.columns.add.apply(this.columns,arguments);return this},removeColumn:function(){this.columns.remove.apply(this.columns,arguments);return this},sort:function(){this.body.sort.apply(this.body,arguments);return this},render:function(){this.$el.empty();this.caption&&this.$el.append(o("<caption>").text(this.caption));this.header&&this.$el.append(this.header.render().$el);this.footer&&this.$el.append(this.footer.render().$el);this.$el.append(this.body.render().$el);this.delegateEvents();this.trigger("backgrid:rendered",this);return this},remove:function(){this.header&&this.header.remove.apply(this.header,arguments);this.body.remove.apply(this.body,arguments);this.footer&&this.footer.remove.apply(this.footer,arguments);return t.View.prototype.remove.apply(this,arguments)}});return l})},1579:function(e,t,i){var r,n,s;
/*
  backgrid-filter
  http://github.com/wyuenho/backgrid

  Copyright (c) 2013 Jimmy Yuen Ho Wong and contributors
  Licensed under the MIT @license.
*/
/*
  backgrid-filter
  http://github.com/wyuenho/backgrid

  Copyright (c) 2013 Jimmy Yuen Ho Wong and contributors
  Licensed under the MIT @license.
*/
(function(o,l){var a;true;!(n=[i(181),i(159),i(1562)],r=l,s="function"===typeof r?r.apply(t,n):r,void 0!==s&&(e.exports=s))})(this,function(e,t,i,r){"use strict";var n={};var s=n.ServerSideFilter=i.Extension.ServerSideFilter=t.View.extend({tagName:"form",className:"backgrid-filter form-search",template:function(e){return'<span class="search">&nbsp;</span><input type="search" '+(e.placeholder?'placeholder="'+e.placeholder+'"':"")+' name="'+e.name+'" '+(e.value?'value="'+e.value+'"':"")+'/><a class="clear" data-backgrid-action="clear" href="#">&times;</a>'},events:{"keyup input[type=search]":"showClearButtonMaybe","click a[data-backgrid-action=clear]":"clear",submit:"search"},name:"q",value:null,placeholder:null,initialize:function(e){s.__super__.initialize.apply(this,arguments);this.name=e.name||this.name;this.value=e.value||this.value;this.placeholder=e.placeholder||this.placeholder;this.template=e.template||this.template;var i=this.collection,r=this;t.PageableCollection&&i instanceof t.PageableCollection&&"server"==i.mode&&(i.queryParams[this.name]=function(){return r.query()||null})},clearSearchBox:function(){this.value=null;this.searchBox().val(null);this.showClearButtonMaybe()},showClearButtonMaybe:function(){var e=this.clearButton();var t=this.query();t?e.show():e.hide()},searchBox:function(){return this.$el.find("input[type=search]")},clearButton:function(){return this.$el.find("a[data-backgrid-action=clear]")},query:function(){this.value=this.searchBox().val();return this.value},search:function(e){e&&e.preventDefault();var i={};var r=this.query();r&&(i[this.name]=r);var n=this.collection;t.PageableCollection&&n instanceof t.PageableCollection?n.getFirstPage({data:i,reset:true,fetch:true}):n.fetch({data:i,reset:true})},clear:function(e){e&&e.preventDefault();this.clearSearchBox();var i=this.collection;t.PageableCollection&&i instanceof t.PageableCollection?i.getFirstPage({reset:true,fetch:true}):i.fetch({reset:true})},render:function(){this.$el.empty().append(this.template({name:this.name,placeholder:this.placeholder,value:this.value}));this.showClearButtonMaybe();this.delegateEvents();return this}});var o=n.ClientSideFilter=i.Extension.ClientSideFilter=s.extend({events:e.extend({},s.prototype.events,{"click a[data-backgrid-action=clear]":function(e){e.preventDefault();this.clear()},"keydown input[type=search]":"search",submit:function(e){e.preventDefault();this.search()}}),fields:null,wait:149,initialize:function(t){o.__super__.initialize.apply(this,arguments);this.fields=t.fields||this.fields;this.wait=t.wait||this.wait;this._debounceMethods(["search","clear"]);var i=this.collection=this.collection.fullCollection||this.collection;var r=this.shadowCollection=i.clone();this.listenTo(i,"add",function(e,t,i){r.add(e,i)});this.listenTo(i,"remove",function(e,t,i){r.remove(e,i)});this.listenTo(i,"sort",function(e){this.query()||r.reset(e.models)});this.listenTo(i,"reset",function(t,i){i=e.extend({reindex:true},i||{});i.reindex&&null==i.from&&null==i.to&&r.reset(t.models)})},_debounceMethods:function(t){e.isString(t)&&(t=[t]);this.undelegateEvents();for(var i=0,r=t.length;i<r;i++){var n=t[i];var s=this[n];this[n]=e.debounce(s,this.wait)}this.delegateEvents()},makeRegExp:function(e){return new RegExp(e.trim().split(/\s+/).join("|"),"i")},makeMatcher:function(e){var t=this.makeRegExp(e);return function(e){var i=this.fields||e.keys();for(var r=0,n=i.length;r<n;r++)if(t.test(e.get(i[r])+""))return true;return false}},search:function(){var t=e.bind(this.makeMatcher(this.query()),this);var i=this.collection;i.pageableCollection&&i.pageableCollection.getFirstPage({silent:true});i.reset(this.shadowCollection.filter(t),{reindex:false})},clear:function(){this.clearSearchBox();var e=this.collection;e.pageableCollection&&e.pageableCollection.getFirstPage({silent:true});e.reset(this.shadowCollection.models,{reindex:false})}});var l=n.LunrFilter=i.Extension.LunrFilter=o.extend({ref:"id",fields:null,initialize:function(e){l.__super__.initialize.apply(this,arguments);this.ref=e.ref||this.ref;var t=this.collection=this.collection.fullCollection||this.collection;this.listenTo(t,"add",this.addToIndex);this.listenTo(t,"remove",this.removeFromIndex);this.listenTo(t,"reset",this.resetIndex);this.listenTo(t,"change",this.updateIndex);this.resetIndex(t)},resetIndex:function(t,i){i=e.extend({reindex:true},i||{});if(i.reindex){var n=this;this.index=r(function(){e.each(n.fields,function(e,t){this.field(t,e);this.ref(n.ref)},this)});t.each(function(e){this.addToIndex(e)},this)}},addToIndex:function(e){var t=this.index;var i=e.toJSON();t.documentStore.has(i[this.ref])?t.update(i):t.add(i)},removeFromIndex:function(e){var t=this.index;var i=e.toJSON();t.documentStore.has(i[this.ref])&&t.remove(i)},updateIndex:function(t){var i=t.changedAttributes();i&&!e.isEmpty(e.intersection(e.keys(this.fields),e.keys(i)))&&this.index.update(t.toJSON())},search:function(){var e=this.collection;if(!this.query()){e.reset(this.shadowCollection.models,{reindex:false});return}var t=this.index.search(this.query());var i=[];for(var r=0;r<t.length;r++){var n=t[r];i.push(this.shadowCollection.get(n.ref))}e.pageableCollection&&e.pageableCollection.getFirstPage({silent:true});e.reset(i,{reindex:false})}});return n})}}]);
//# sourceMappingURL=4.d895581d04.js.map