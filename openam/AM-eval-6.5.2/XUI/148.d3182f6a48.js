(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[148,172,173],{1173:function(e,t,a){var r=a(62);e.exports=(r["default"]||r).template({1:function(e,t,a,r,l){var n=e.lambda,s=e.escapeExpression;return'        <option value="'+s(n(t,t))+'" selected="selected">'+s(n(t,t))+"</option>\n"},compiler:[7,">= 4.0.0"],main:function(e,t,a,r,l){var n;return'<select multiple="multiple">\n'+(null!=(n=a.each.call(null!=t?t:e.nullContext||{},null!=(n=null!=t?t.attributes:t)?n.permissions:n,{name:"each",hash:{},fn:e.program(1,l,0),inverse:e.noop,data:l}))?n:"")+"</select>\n"},useData:true})},1192:function(e,t,a){var r=a(62);e.exports=(r["default"]||r).template({compiler:[7,">= 4.0.0"],main:function(e,t,a,r,l){var n=null!=t?t:e.nullContext||{},s=a.helperMissing,o=e.escapeExpression;return'<div class="pull-right">\n  <button type="button" class="btn btn-xs btn-primary" data-permission="allow">'+o((a.t||t&&t.t||s).call(n,"common.form.allow",{name:"t",hash:{},data:l}))+'</button>\n  <button type="button" class="btn btn-xs btn-default" data-permission="deny">'+o((a.t||t&&t.t||s).call(n,"common.form.deny",{name:"t",hash:{},data:l}))+"</button>\n</div>\n"},useData:true})},1310:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});a(1572);a(1554);var r=a(19);var l=R(r);var n=a(159);var s=R(n);var o=a(114);var u=R(o);var i=a(1192);var d=R(i);var c=a(1535);var f=R(c);var p=a(1546);var h=R(p);var m=a(37);var v=R(m);var g=a(27);var b=R(g);var y=a(168);var _=R(y);var C=a(1646);var x=R(C);var S=a(1561);var q=R(S);function R(e){return e&&e.__esModule?e:{default:e}}var P=u.default.extend({template:"user/uma/views/request/ListRequestTemplate",render:function e(t,a){var r=this,n,o,u,i;i=s.default.PageableCollection.extend({url:b.default.context+"/json"+(0,_.default)("/users/"+v.default.loggedUser.get("username")+"/uma/pendingrequests"),state:{pageSize:10,sortKey:"user"},queryParams:{pageSize:"_pageSize",_sortKeys:h.default.sortKeys,_queryId:"*",_queryFilter:"true",_pagedResultsOffset:h.default.pagedResultsOffset},parseState:h.default.parseState,parseRecords:h.default.parseRecords,sync:h.default.sync});n=[{name:"user",label:l.default.t("uma.requests.grid.header.0"),cell:"string",editable:false},{name:"resource",label:l.default.t("uma.requests.grid.header.1"),cell:"string",editable:false},{name:"when",label:l.default.t("uma.requests.grid.header.2"),cell:h.default.DatetimeAgoCell,editable:false},{name:"permissions",label:l.default.t("uma.requests.grid.header.3"),headerCell:h.default.ClassHeaderCell.extend({className:"col-xs-7 col-md-6"}),cell:x.default.extend({onChange:function e(t){this.model.set("permissions",t,{silent:true});var a=null!==t;this.$el.parent().find("[data-permission=allow]").prop("disabled",!a)}}),editable:false},{name:"actions",label:"",cell:h.default.TemplateCell.extend({template:d.default,events:{"click button[data-permission=allow]":"allow","click button[data-permission=deny]":"deny"},allow:function e(){q.default.approveRequest(this.model.get("_id"),this.model.get("permissions")).then(function(){r.data.requests.fetch({reset:true,processData:false})})},deny:function e(){q.default.denyRequest(this.model.get("_id")).then(function(){r.data.requests.fetch({reset:true,processData:false})})}}),editable:false}];this.data.requests=new i;this.data.requests.on("backgrid:sort",h.default.doubleSortFix);o=new f.default.Grid({columns:n,className:"backgrid table",collection:r.data.requests,emptyText:l.default.t("console.common.noResults")});u=new f.default.Extension.ThemeablePaginator({collection:r.data.requests,windowSize:3});r.parentRender(function(){r.$el.find(".table-container").append(o.render().el);r.$el.find(".panel-body").append(u.render().el);r.data.requests.fetch({reset:true,processData:false}).then(function(){a&&a()})})}});t.default=new P},1535:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=a(19);var l=o(r);var n=a(1562);var s=o(n);function o(e){return e&&e.__esModule?e:{default:e}}s.default.HeaderCell.prototype.render=function(){this.$el.empty();var e=this.column,t=s.default.callByNeed(e.sortable(),e,this.collection),a;a=t?(0,l.default)("<a>").text(e.get("label")).append("<b class='sort-caret'></b>"):document.createTextNode(e.get("label"));this.$el.append(a);this.$el.attr("data-field",e.get("name"));this.$el.addClass(e.get("direction"));this.delegateEvents();return this};t.default=s.default},1546:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};a(1552);var l=a(6);var n=b(l);var s=a(19);var o=b(s);var u=a(159);var i=b(u);var d=a(12);var c=b(d);var f=a(1535);var p=b(f);var h=a(560);var m=b(h);var v=a(73);var g=b(v);function b(e){return e&&e.__esModule?e:{default:e}}var y={};y.DatetimeAgoCell=p.default.Cell.extend({className:"date-time-ago-cell",formatter:{fromRaw:function e(t){return(0,c.default)(t).fromNow()}},render:function e(){y.DatetimeAgoCell.__super__.render.apply(this);this.$el.attr("title",(0,c.default)(this.model.get(this.column.get("name"))).format("Do MMMM YYYY, h:mm:ssa"));return this}});y.ArrayCell=p.default.Cell.extend({className:"array-formatter-cell",buildHtml:function e(t){var a="<ul>",r=0;for(;r<t.length;r++)n.default.isString(t[r])?a+="<li>"+t[r]+"</li>":a+="<li>"+JSON.stringify(t[r])+"</li>";a+="</ul>";return a},render:function e(){this.$el.empty();var t=this.model.get(this.column.attributes.name);this.$el.append(this.buildHtml(t));this.delegateEvents();return this}});y.ObjectCell=p.default.Cell.extend({className:"object-formatter-cell",render:function e(){this.$el.empty();var t=this.model.get(this.column.attributes.name),a='<dl class="dl-horizontal">',r;for(r in t)n.default.isString(t[r])?a+="<dt>"+r+"</dt><dd>"+t[r]+"</dd>":a+="<dt>"+r+"</dt><dd>"+JSON.stringify(t[r])+"</dd>";a+="</dl>";this.$el.append(a);this.delegateEvents();return this}});y.UniversalIdToUsername=p.default.Cell.extend({formatter:{fromRaw:function e(t){return t.substring(3,t.indexOf(",ou=user"))}},render:function e(){y.UniversalIdToUsername.__super__.render.apply(this);this.$el.attr("title",this.model.get(this.column.get("name")));return this}});y.ClickableRow=p.default.Row.extend({events:{click:"onClick",keyup:"onKeyup"},onKeyup:function e(t){13===t.keyCode&&this.callback&&this.callback(t)},onClick:function e(t){this.callback&&this.callback(t)}});y.TemplateCell=p.default.Cell.extend({className:"template-cell",render:function e(){var t=this.template(this.model);this.$el.html(t);this.rendered&&this.rendered();this.delegateEvents();return this}});y.ClassHeaderCell=p.default.HeaderCell.extend({className:"",render:function e(){y.ClassHeaderCell.__super__.render.apply(this);this.delegateEvents();return this}});y.UriExtCell=p.default.UriCell.extend({events:{click:"gotoUrl"},render:function e(){this.$el.empty();var t=this.model.get(this.column.get("name")),a=this.formatter.fromRaw(t,this.model),r=n.default.isFunction(this.column.get("href"))?this.column.get("href")(t,a,this.model):this.column.get("href");this.$el.append((0,o.default)("<a>",{href:r||t,title:this.title||a}).text(a));if(r){this.$el.data("href",r);this.$el.prop("title",this.title||a)}this.delegateEvents();return this},gotoUrl:function e(t){t.preventDefault();var a=(0,o.default)(t.currentTarget).data("href");g.default.navigate(a,{trigger:true})}});y.FilterHeaderCell=p.default.HeaderCell.extend({className:"filter-header-cell enable-pointer",render:function e(){var t=new p.default.Extension.ThemeableServerSideFilter({name:this.column.get("name"),placeholder:o.default.t("common.form.filter"),collection:this.collection});this.addClassName&&this.$el.addClass(this.addClassName);this.collection.state.filters=this.collection.state.filters?this.collection.state.filters:[];this.collection.state.filters.push(t);y.FilterHeaderCell.__super__.render.apply(this);this.$el.prepend(t.render().el);return this}});y.queryFilter=function(e){void 0===e&&(e={});var t=[],a=e._queryFilter||[],r=function(){return e&&e.filterName&&"eq"===e.filterName?function(e,t){return e+"+eq+"+encodeURIComponent('"*'+t+'*"')}:function(e,t){return e+"+co+"+encodeURIComponent('"'+t+'"')}}();n.default.each(this.state.filters,function(e){""!==e.query()&&t.push(r(e.name,e.query()))});t=t.concat(a);return 0===t.length||t.join("+AND+")};y.parseState=function(e){this.state.totalRecords||(this.state.totalRecords=e.remainingPagedResults+e.resultCount);this.state.totalPages||(this.state.totalPages=Math.ceil(this.state.totalRecords/this.state.pageSize));return this.state};y.pagedResultsOffset=function(){return(this.state.currentPage-1)*this.state.pageSize};y.sortKeys=function(){return 1===this.state.order?"-"+this.state.sortKey:this.state.sortKey};y.sync=function(e,t,a){var r=[],l=["_pageSize","_pagedResultsOffset","_sortKeys"];"*"===a.data._queryId&&true===a.data._queryFilter?l.push("_queryId"):l.push("_queryFilter");n.default.forIn(a.data,function(e,t){n.default.includes(l,t)&&r.push(t+"="+e)});a.data=r.join("&");a.processData=false;a.beforeSend||(a.beforeSend=function(e){e.setRequestHeader("Accept-API-Version","protocol=1.0,resource=1.0")});a.error=function(e){m.default.addMessage({type:m.default.TYPE_DANGER,response:e})};return i.default.sync(e,t,a)};y.parseRecords=function(e){return e.result};y.getQueryParams=function(e){e=e||{};return{_sortKeys:this.sortKeys,_queryFilter:function t(){return y.queryFilter.call(this,e)},pageSize:"_pageSize",_pagedResultsOffset:this.pagedResultsOffset}};y.doubleSortFix=function(e){var t=e.cid,a=e.collection.filter(function(e){return e.cid!==t});n.default.each(a,function(e){e.set("direction",null)})};y.getState=function(e){var t={pageSize:20,sortKey:"name"};e&&"object"===("undefined"===typeof e?"undefined":r(e))&&n.default.extend(t,e);return t};t.default=y},1552:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});a(1579);var r=a(6);var l=i(r);var n=a(19);var s=i(n);var o=a(1535);var u=i(o);function i(e){return e&&e.__esModule?e:{default:e}}u.default.Extension.ThemeableServerSideFilter=u.default.Extension.ServerSideFilter.extend({events:l.default.extend(u.default.Extension.ServerSideFilter.prototype.events,{"keyup input[type=search]":"keyupSearch"}),keyupSearch:function e(t){t.preventDefault();this.showClearButtonMaybe(t);this.minimumSearchChars&&(0,s.default)(t.target).val().length>=this.minimumSearchChars&&this.search(t)},className:"form-group has-feedback",template:function e(t){return'<input class="form-control input-sm" type="search" '+(t.placeholder?'placeholder="'+t.placeholder+'"':"")+' name="'+t.name+'" '+(t.value?'value="'+t.value+'"':"")+'/><a class="fa fa-times form-control-feedback" data-backgrid-action="clear" role="button" href="#"></a>'}});t.default=u.default.Extension.ThemeableServerSideFilter},1554:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});a(1588);var r=a(19);var l=o(r);var n=a(1535);var s=o(n);function o(e){return e&&e.__esModule?e:{default:e}}s.default.Extension.ThemeablePaginator=s.default.Extension.Paginator.extend({className:"text-center",controls:{rewind:{label:"&laquo;",title:l.default.t("common.grid.pagination.first")},back:{label:"&lsaquo;",title:l.default.t("common.grid.pagination.previous")},forward:{label:"&rsaquo;",title:l.default.t("common.grid.pagination.next")},fastForward:{label:"&raquo;",title:l.default.t("common.grid.pagination.last")}},ulClassName:"pagination",render:function e(){s.default.Extension.Paginator.prototype.render.call(this);this.ulClassName&&this.$el.find("ul").addClass(this.ulClassName);return this}});t.default=s.default.Extension.ThemeablePaginator},1561:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=a(6);var l=p(r);var n=a(169);var s=p(n);var o=a(37);var u=p(o);var i=a(27);var d=p(i);var c=a(168);var f=p(c);function p(e){return e&&e.__esModule?e:{default:e}}var h=new s.default(""+d.default.host+d.default.context+"/json");h.getUmaConfig=function(){return h.serviceCall({url:(0,f.default)("/serverinfo/uma"),headers:{"Accept-API-Version":"protocol=1.0,resource=1.0"}}).then(function(e){u.default.globalData.auth.uma=u.default.globalData.auth.uma||{};u.default.globalData.auth.uma.enabled=e.enabled;u.default.globalData.auth.uma.resharingMode=e.resharingMode;return e})};h.unshareAllResources=function(){var e=encodeURIComponent(u.default.loggedUser.get("username"));return h.serviceCall({url:(0,f.default)("/users/"+e+"/oauth2/resources/sets?_action=revokeAll"),headers:{"Accept-API-Version":"protocol=1.0,resource=1.0"},type:"POST"})};h.approveRequest=function(e,t){return h.serviceCall({url:(0,f.default)("/users/"+encodeURIComponent(u.default.loggedUser.get("username"))+"/uma/pendingrequests/"+e+"?_action=approve"),headers:{"Accept-API-Version":"protocol=1.0,resource=1.0"},type:"POST",data:JSON.stringify({scopes:t})})};h.denyRequest=function(e){return h.serviceCall({url:(0,f.default)("/users/"+encodeURIComponent(u.default.loggedUser.get("username"))+"/uma/pendingrequests/"+e+"?_action=deny"),headers:{"Accept-API-Version":"protocol=1.0,resource=1.0"},type:"POST"})};h.labels={all:function e(){return h.serviceCall({url:(0,f.default)("/users/"+encodeURIComponent(u.default.loggedUser.get("username"))+"/oauth2/resources/labels?_queryFilter=true"),headers:{"Accept-API-Version":"protocol=1.0,resource=1.0"}})},create:function e(t,a){return h.serviceCall({url:(0,f.default)("/users/"+encodeURIComponent(u.default.loggedUser.get("username"))+"/oauth2/resources/labels?_action=create"),headers:{"Accept-API-Version":"protocol=1.0,resource=1.0"},type:"POST",data:JSON.stringify({name:t,type:a})})},get:function e(t){return h.serviceCall({url:(0,f.default)("/users/"+encodeURIComponent(u.default.loggedUser.get("username"))+"/oauth2/resources/labels?_queryFilter=true"),headers:{"Accept-API-Version":"protocol=1.0,resource=1.0"}}).then(function(e){return l.default.find(e.result,{_id:t})})},remove:function e(t){return h.serviceCall({url:(0,f.default)("/users/"+encodeURIComponent(u.default.loggedUser.get("username"))+"/oauth2/resources/labels/"+encodeURIComponent(t)),headers:{"Accept-API-Version":"protocol=1.0,resource=1.0"},type:"DELETE"})}};t.default=h},1646:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});a(1531);var r=a(1546);var l=o(r);var n=a(1173);var s=o(n);function o(e){return e&&e.__esModule?e:{default:e}}t.default=l.default.TemplateCell.extend({className:"permissions-cell",template:s.default,onChange:function e(){},rendered:function e(){this.$el.find("select").selectize({dropdownParent:"body",onChange:this.onChange.bind(this)})}})}}]);
//# sourceMappingURL=148.d3182f6a48.js.map