(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[149,172],{1173:function(e,t,r){var a=r(62);e.exports=(a["default"]||a).template({1:function(e,t,r,a,l){var n=e.lambda,s=e.escapeExpression;return'        <option value="'+s(n(t,t))+'" selected="selected">'+s(n(t,t))+"</option>\n"},compiler:[7,">= 4.0.0"],main:function(e,t,r,a,l){var n;return'<select multiple="multiple">\n'+(null!=(n=r.each.call(null!=t?t:e.nullContext||{},null!=(n=null!=t?t.attributes:t)?n.permissions:n,{name:"each",hash:{},fn:e.program(1,l,0),inverse:e.noop,data:l}))?n:"")+"</select>\n"},useData:true})},1311:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var a=r(19);var l=x(a);var n=r(159);var s=x(n);var u=r(1535);var o=x(u);var i=r(114);var d=x(i);var c=r(37);var f=x(c);var h=r(73);var p=x(h);var m=r(27);var v=x(m);var g=r(168);var y=x(g);var b=r(1546);var C=x(b);var _=r(1561);var R=x(_);var S=r(1646);var q=x(S);function x(e){return e&&e.__esModule?e:{default:e}}var U=d.default.extend({template:"user/uma/views/request/EditRequestTemplate",events:{"click button[data-permission=allow]":"allowRequest","click button[data-permission=deny]":"denyRequest"},allowRequest:function e(){R.default.approveRequest(this.model.get("_id"),this.model.get("permissions")).then(function(){p.default.routeTo(p.default.configuration.routes.umaRequestList,{args:[],trigger:true})})},denyRequest:function e(){R.default.denyRequest(this.model.get("_id")).then(function(){p.default.routeTo(p.default.configuration.routes.umaRequestList,{args:[],trigger:true})})},render:function e(t,r){var a=this,n=null,u,i,d;n=t[0];d=s.default.Collection.extend({url:v.default.context+"/json"+(0,y.default)("/users/"+f.default.loggedUser.get("username")+"/uma/pendingrequests/"+n)});u=[{name:"user",label:l.default.t("uma.requests.grid.header.0"),cell:"string",editable:false},{name:"resource",label:l.default.t("uma.requests.grid.header.1"),cell:"string",editable:false},{name:"when",label:l.default.t("uma.requests.grid.header.2"),cell:C.default.DatetimeAgoCell,editable:false},{name:"permissions",label:l.default.t("uma.requests.grid.header.3"),headerCell:C.default.ClassHeaderCell.extend({className:"col-xs-7 col-md-6"}),cell:q.default.extend({onChange:function e(t){this.model.set("permissions",t,{silent:true});var r=null!==t;this.$el.parent().find("[data-permission=allow]").prop("disabled",!r)}}),editable:false}];this.data.requests=new d;i=new o.default.Grid({columns:u,className:"backgrid table",collection:this.data.requests,emptyText:l.default.t("console.common.noResults")});this.parentRender(function(){a.$el.find(".table-container").append(i.render().el);a.data.requests.fetch({reset:true,processData:false}).then(function(){a.model=a.data.requests.findWhere({_id:n});r&&r()},function(){a.$el.find("button[data-permission]").prop("disabled",true)})})}});t.default=new U},1535:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var a=r(19);var l=u(a);var n=r(1562);var s=u(n);function u(e){return e&&e.__esModule?e:{default:e}}s.default.HeaderCell.prototype.render=function(){this.$el.empty();var e=this.column,t=s.default.callByNeed(e.sortable(),e,this.collection),r;r=t?(0,l.default)("<a>").text(e.get("label")).append("<b class='sort-caret'></b>"):document.createTextNode(e.get("label"));this.$el.append(r);this.$el.attr("data-field",e.get("name"));this.$el.addClass(e.get("direction"));this.delegateEvents();return this};t.default=s.default},1546:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r(1552);var l=r(6);var n=y(l);var s=r(19);var u=y(s);var o=r(159);var i=y(o);var d=r(12);var c=y(d);var f=r(1535);var h=y(f);var p=r(560);var m=y(p);var v=r(73);var g=y(v);function y(e){return e&&e.__esModule?e:{default:e}}var b={};b.DatetimeAgoCell=h.default.Cell.extend({className:"date-time-ago-cell",formatter:{fromRaw:function e(t){return(0,c.default)(t).fromNow()}},render:function e(){b.DatetimeAgoCell.__super__.render.apply(this);this.$el.attr("title",(0,c.default)(this.model.get(this.column.get("name"))).format("Do MMMM YYYY, h:mm:ssa"));return this}});b.ArrayCell=h.default.Cell.extend({className:"array-formatter-cell",buildHtml:function e(t){var r="<ul>",a=0;for(;a<t.length;a++)n.default.isString(t[a])?r+="<li>"+t[a]+"</li>":r+="<li>"+JSON.stringify(t[a])+"</li>";r+="</ul>";return r},render:function e(){this.$el.empty();var t=this.model.get(this.column.attributes.name);this.$el.append(this.buildHtml(t));this.delegateEvents();return this}});b.ObjectCell=h.default.Cell.extend({className:"object-formatter-cell",render:function e(){this.$el.empty();var t=this.model.get(this.column.attributes.name),r='<dl class="dl-horizontal">',a;for(a in t)n.default.isString(t[a])?r+="<dt>"+a+"</dt><dd>"+t[a]+"</dd>":r+="<dt>"+a+"</dt><dd>"+JSON.stringify(t[a])+"</dd>";r+="</dl>";this.$el.append(r);this.delegateEvents();return this}});b.UniversalIdToUsername=h.default.Cell.extend({formatter:{fromRaw:function e(t){return t.substring(3,t.indexOf(",ou=user"))}},render:function e(){b.UniversalIdToUsername.__super__.render.apply(this);this.$el.attr("title",this.model.get(this.column.get("name")));return this}});b.ClickableRow=h.default.Row.extend({events:{click:"onClick",keyup:"onKeyup"},onKeyup:function e(t){13===t.keyCode&&this.callback&&this.callback(t)},onClick:function e(t){this.callback&&this.callback(t)}});b.TemplateCell=h.default.Cell.extend({className:"template-cell",render:function e(){var t=this.template(this.model);this.$el.html(t);this.rendered&&this.rendered();this.delegateEvents();return this}});b.ClassHeaderCell=h.default.HeaderCell.extend({className:"",render:function e(){b.ClassHeaderCell.__super__.render.apply(this);this.delegateEvents();return this}});b.UriExtCell=h.default.UriCell.extend({events:{click:"gotoUrl"},render:function e(){this.$el.empty();var t=this.model.get(this.column.get("name")),r=this.formatter.fromRaw(t,this.model),a=n.default.isFunction(this.column.get("href"))?this.column.get("href")(t,r,this.model):this.column.get("href");this.$el.append((0,u.default)("<a>",{href:a||t,title:this.title||r}).text(r));if(a){this.$el.data("href",a);this.$el.prop("title",this.title||r)}this.delegateEvents();return this},gotoUrl:function e(t){t.preventDefault();var r=(0,u.default)(t.currentTarget).data("href");g.default.navigate(r,{trigger:true})}});b.FilterHeaderCell=h.default.HeaderCell.extend({className:"filter-header-cell enable-pointer",render:function e(){var t=new h.default.Extension.ThemeableServerSideFilter({name:this.column.get("name"),placeholder:u.default.t("common.form.filter"),collection:this.collection});this.addClassName&&this.$el.addClass(this.addClassName);this.collection.state.filters=this.collection.state.filters?this.collection.state.filters:[];this.collection.state.filters.push(t);b.FilterHeaderCell.__super__.render.apply(this);this.$el.prepend(t.render().el);return this}});b.queryFilter=function(e){void 0===e&&(e={});var t=[],r=e._queryFilter||[],a=function(){return e&&e.filterName&&"eq"===e.filterName?function(e,t){return e+"+eq+"+encodeURIComponent('"*'+t+'*"')}:function(e,t){return e+"+co+"+encodeURIComponent('"'+t+'"')}}();n.default.each(this.state.filters,function(e){""!==e.query()&&t.push(a(e.name,e.query()))});t=t.concat(r);return 0===t.length||t.join("+AND+")};b.parseState=function(e){this.state.totalRecords||(this.state.totalRecords=e.remainingPagedResults+e.resultCount);this.state.totalPages||(this.state.totalPages=Math.ceil(this.state.totalRecords/this.state.pageSize));return this.state};b.pagedResultsOffset=function(){return(this.state.currentPage-1)*this.state.pageSize};b.sortKeys=function(){return 1===this.state.order?"-"+this.state.sortKey:this.state.sortKey};b.sync=function(e,t,r){var a=[],l=["_pageSize","_pagedResultsOffset","_sortKeys"];"*"===r.data._queryId&&true===r.data._queryFilter?l.push("_queryId"):l.push("_queryFilter");n.default.forIn(r.data,function(e,t){n.default.includes(l,t)&&a.push(t+"="+e)});r.data=a.join("&");r.processData=false;r.beforeSend||(r.beforeSend=function(e){e.setRequestHeader("Accept-API-Version","protocol=1.0,resource=1.0")});r.error=function(e){m.default.addMessage({type:m.default.TYPE_DANGER,response:e})};return i.default.sync(e,t,r)};b.parseRecords=function(e){return e.result};b.getQueryParams=function(e){e=e||{};return{_sortKeys:this.sortKeys,_queryFilter:function t(){return b.queryFilter.call(this,e)},pageSize:"_pageSize",_pagedResultsOffset:this.pagedResultsOffset}};b.doubleSortFix=function(e){var t=e.cid,r=e.collection.filter(function(e){return e.cid!==t});n.default.each(r,function(e){e.set("direction",null)})};b.getState=function(e){var t={pageSize:20,sortKey:"name"};e&&"object"===("undefined"===typeof e?"undefined":a(e))&&n.default.extend(t,e);return t};t.default=b},1552:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});r(1579);var a=r(6);var l=i(a);var n=r(19);var s=i(n);var u=r(1535);var o=i(u);function i(e){return e&&e.__esModule?e:{default:e}}o.default.Extension.ThemeableServerSideFilter=o.default.Extension.ServerSideFilter.extend({events:l.default.extend(o.default.Extension.ServerSideFilter.prototype.events,{"keyup input[type=search]":"keyupSearch"}),keyupSearch:function e(t){t.preventDefault();this.showClearButtonMaybe(t);this.minimumSearchChars&&(0,s.default)(t.target).val().length>=this.minimumSearchChars&&this.search(t)},className:"form-group has-feedback",template:function e(t){return'<input class="form-control input-sm" type="search" '+(t.placeholder?'placeholder="'+t.placeholder+'"':"")+' name="'+t.name+'" '+(t.value?'value="'+t.value+'"':"")+'/><a class="fa fa-times form-control-feedback" data-backgrid-action="clear" role="button" href="#"></a>'}});t.default=o.default.Extension.ThemeableServerSideFilter},1561:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var a=r(6);var l=h(a);var n=r(169);var s=h(n);var u=r(37);var o=h(u);var i=r(27);var d=h(i);var c=r(168);var f=h(c);function h(e){return e&&e.__esModule?e:{default:e}}var p=new s.default(""+d.default.host+d.default.context+"/json");p.getUmaConfig=function(){return p.serviceCall({url:(0,f.default)("/serverinfo/uma"),headers:{"Accept-API-Version":"protocol=1.0,resource=1.0"}}).then(function(e){o.default.globalData.auth.uma=o.default.globalData.auth.uma||{};o.default.globalData.auth.uma.enabled=e.enabled;o.default.globalData.auth.uma.resharingMode=e.resharingMode;return e})};p.unshareAllResources=function(){var e=encodeURIComponent(o.default.loggedUser.get("username"));return p.serviceCall({url:(0,f.default)("/users/"+e+"/oauth2/resources/sets?_action=revokeAll"),headers:{"Accept-API-Version":"protocol=1.0,resource=1.0"},type:"POST"})};p.approveRequest=function(e,t){return p.serviceCall({url:(0,f.default)("/users/"+encodeURIComponent(o.default.loggedUser.get("username"))+"/uma/pendingrequests/"+e+"?_action=approve"),headers:{"Accept-API-Version":"protocol=1.0,resource=1.0"},type:"POST",data:JSON.stringify({scopes:t})})};p.denyRequest=function(e){return p.serviceCall({url:(0,f.default)("/users/"+encodeURIComponent(o.default.loggedUser.get("username"))+"/uma/pendingrequests/"+e+"?_action=deny"),headers:{"Accept-API-Version":"protocol=1.0,resource=1.0"},type:"POST"})};p.labels={all:function e(){return p.serviceCall({url:(0,f.default)("/users/"+encodeURIComponent(o.default.loggedUser.get("username"))+"/oauth2/resources/labels?_queryFilter=true"),headers:{"Accept-API-Version":"protocol=1.0,resource=1.0"}})},create:function e(t,r){return p.serviceCall({url:(0,f.default)("/users/"+encodeURIComponent(o.default.loggedUser.get("username"))+"/oauth2/resources/labels?_action=create"),headers:{"Accept-API-Version":"protocol=1.0,resource=1.0"},type:"POST",data:JSON.stringify({name:t,type:r})})},get:function e(t){return p.serviceCall({url:(0,f.default)("/users/"+encodeURIComponent(o.default.loggedUser.get("username"))+"/oauth2/resources/labels?_queryFilter=true"),headers:{"Accept-API-Version":"protocol=1.0,resource=1.0"}}).then(function(e){return l.default.find(e.result,{_id:t})})},remove:function e(t){return p.serviceCall({url:(0,f.default)("/users/"+encodeURIComponent(o.default.loggedUser.get("username"))+"/oauth2/resources/labels/"+encodeURIComponent(t)),headers:{"Accept-API-Version":"protocol=1.0,resource=1.0"},type:"DELETE"})}};t.default=p},1646:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});r(1531);var a=r(1546);var l=u(a);var n=r(1173);var s=u(n);function u(e){return e&&e.__esModule?e:{default:e}}t.default=l.default.TemplateCell.extend({className:"permissions-cell",template:s.default,onChange:function e(){},rendered:function e(){this.$el.find("select").selectize({dropdownParent:"body",onChange:this.onChange.bind(this)})}})}}]);
//# sourceMappingURL=149.878019ef34.js.map